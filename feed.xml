<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.2">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2026-01-11T12:31:15+00:00</updated><id>/feed.xml</id><title type="html">Spark NLP</title><subtitle>High Performance NLP with Apache Spark
</subtitle><author><name>{&quot;type&quot;=&gt;nil, &quot;name&quot;=&gt;nil, &quot;url&quot;=&gt;nil, &quot;avatar&quot;=&gt;nil, &quot;bio&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;facebook&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil, &quot;weibo&quot;=&gt;nil, &quot;googleplus&quot;=&gt;nil, &quot;telegram&quot;=&gt;nil, &quot;medium&quot;=&gt;nil, &quot;zhihu&quot;=&gt;nil, &quot;douban&quot;=&gt;nil, &quot;linkedin&quot;=&gt;nil, &quot;github&quot;=&gt;nil, &quot;npm&quot;=&gt;nil}</name></author><entry><title type="html">Clinical Deidentification Pipeline Large v2 (Document Wise)</title><link href="/2025/12/14/clinical_deidentification_docwise_benchmark_large_v2_en.html" rel="alternate" type="text/html" title="Clinical Deidentification Pipeline Large v2 (Document Wise)" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>/2025/12/14/clinical_deidentification_docwise_benchmark_large_v2_en</id><content type="html" xml:base="/2025/12/14/clinical_deidentification_docwise_benchmark_large_v2_en.html">## Description

This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text.
The pipeline can mask and obfuscate 'DATE', 'LOCATION', 'PROFESSION', 'DOCTOR', 'EMAIL','PATIENT', 'URL', 'USERNAME',
'CITY', 'COUNTRY', 'DLN', 'HOSPITAL', 'IDNUM', 'MEDICALRECORD', 'STATE', 'STREET', 'ZIP', 'AGE', 'PHONE', 'ORGANIZATION','SSN', 'ACCOUNT',
'PLATE', 'VIN', 'LICENSE', 'IP' entities.

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_large_v2_en_6.2.2_3.4_1765730686060.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_large_v2_en_6.2.2_3.4_1765730686060.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)


```

{:.jsl-block}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

val deid_result = deid_pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash
|    | text                                                                                       | result                                                                                                                                                                                            | result                                                                                                                                                                                                                                |
|---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &lt;DOCTOR&gt;, from &lt;HOSPITAL&gt; in &lt;CITY&gt;, attended to the patient on &lt;DATE&gt;.\nThe patient’s medical record number is &lt;IDNUM&gt;.\nThe patient, &lt;PATIENT&gt;, is &lt;AGE&gt;, her Contact number: &lt;PHONE&gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 12/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] |
|    | The patient’s medical record number is 56467890.                                           |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
|    | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .              |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|clinical_deidentification_docwise_benchmark_large_v2|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|3.5 GB|

## Included Models

- DocumentAssembler
- InternalDocumentSplitter
- TokenizerModel
- TokenizerModel
- WordEmbeddingsModel
- MedicalNerModel
- NerConverterInternalModel
- PretrainedZeroShotNERChunker
- MedicalNerModel
- NerConverterInternalModel
- ChunkMergeModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- ChunkMergeModel
- ChunkMergeModel
- ChunkMergeModel
- LightDeIdentification
- LightDeIdentification</content><author><name>John Snow Labs</name></author><category term="deidentification" /><category term="deid" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="pipeline" /><category term="docwise" /><summary type="html">Description This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text. The pipeline can mask and obfuscate ‘DATE’, ‘LOCATION’, ‘PROFESSION’, ‘DOCTOR’, ‘EMAIL’,’PATIENT’, ‘URL’, ‘USERNAME’, ‘CITY’, ‘COUNTRY’, ‘DLN’, ‘HOSPITAL’, ‘IDNUM’, ‘MEDICALRECORD’, ‘STATE’, ‘STREET’, ‘ZIP’, ‘AGE’, ‘PHONE’, ‘ORGANIZATION’,’SSN’, ‘ACCOUNT’, ‘PLATE’, ‘VIN’, ‘LICENSE’, ‘IP’ entities. Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) from sparknlp.pretrained import PretrainedPipeline deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_large_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; val deid_result = deid_pipeline.fullAnnotate(text) Results | | text | result | result | |---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| | 0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &amp;lt;DOCTOR&amp;gt;, from &amp;lt;HOSPITAL&amp;gt; in &amp;lt;CITY&amp;gt;, attended to the patient on &amp;lt;DATE&amp;gt;.\nThe patient’s medical record number is &amp;lt;IDNUM&amp;gt;.\nThe patient, &amp;lt;PATIENT&amp;gt;, is &amp;lt;AGE&amp;gt;, her Contact number: &amp;lt;PHONE&amp;gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 12/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] | | | The patient’s medical record number is 56467890. | | | | | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 . | | | Model Information Model Name: clinical_deidentification_docwise_benchmark_large_v2 Type: pipeline Compatibility: Healthcare NLP 6.2.2+ License: Licensed Edition: Official Language: en Size: 3.5 GB Included Models DocumentAssembler InternalDocumentSplitter TokenizerModel TokenizerModel WordEmbeddingsModel MedicalNerModel NerConverterInternalModel PretrainedZeroShotNERChunker MedicalNerModel NerConverterInternalModel ChunkMergeModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel ContextualParserModel ContextualParserModel ChunkMergeModel ChunkMergeModel ChunkMergeModel LightDeIdentification LightDeIdentification</summary></entry><entry><title type="html">Clinical Deidentification Pipeline Medium v2 (Document Wise)</title><link href="/2025/12/14/clinical_deidentification_docwise_benchmark_medium_v2_en.html" rel="alternate" type="text/html" title="Clinical Deidentification Pipeline Medium v2 (Document Wise)" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>/2025/12/14/clinical_deidentification_docwise_benchmark_medium_v2_en</id><content type="html" xml:base="/2025/12/14/clinical_deidentification_docwise_benchmark_medium_v2_en.html">## Description

This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text.
The pipeline can mask and obfuscate 'DATE', 'LOCATION', 'PROFESSION', 'DOCTOR', 'EMAIL','PATIENT', 'URL', 'USERNAME',
'CITY', 'COUNTRY', 'DLN', 'HOSPITAL', 'IDNUM', 'MEDICALRECORD', 'STATE', 'STREET', 'ZIP', 'AGE', 'PHONE', 'ORGANIZATION','SSN', 'ACCOUNT',
'PLATE', 'VIN', 'LICENSE', 'IP' entities.

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_medium_v2_en_6.2.2_3.4_1765730665630.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_medium_v2_en_6.2.2_3.4_1765730665630.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)


```

{:.jsl-block}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

val deid_result = deid_pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash
|    | text                                                                                       | result                                                                                                                                                                                            | result                                                                                                                                                                                                                                |
|---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &lt;DOCTOR&gt;, from &lt;HOSPITAL&gt; in &lt;CITY&gt;, attended to the patient on &lt;DATE&gt;.\nThe patient’s medical record number is &lt;IDNUM&gt;.\nThe patient, &lt;PATIENT&gt;, is &lt;AGE&gt;, her Contact number: &lt;PHONE&gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 12/05/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] |
|    | The patient’s medical record number is 56467890.                                           |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
|    | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .              |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|clinical_deidentification_docwise_benchmark_medium_v2|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|2.5 GB|

## Included Models

- DocumentAssembler
- InternalDocumentSplitter
- TokenizerModel
- TokenizerModel
- WordEmbeddingsModel
- MedicalNerModel
- NerConverterInternalModel
- PretrainedZeroShotNERChunker
- MedicalNerModel
- NerConverterInternalModel
- ChunkMergeModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- ChunkMergeModel
- ChunkMergeModel
- ChunkMergeModel
- LightDeIdentification
- LightDeIdentification</content><author><name>John Snow Labs</name></author><category term="deidentification" /><category term="deid" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="pipeline" /><category term="docwise" /><summary type="html">Description This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text. The pipeline can mask and obfuscate ‘DATE’, ‘LOCATION’, ‘PROFESSION’, ‘DOCTOR’, ‘EMAIL’,’PATIENT’, ‘URL’, ‘USERNAME’, ‘CITY’, ‘COUNTRY’, ‘DLN’, ‘HOSPITAL’, ‘IDNUM’, ‘MEDICALRECORD’, ‘STATE’, ‘STREET’, ‘ZIP’, ‘AGE’, ‘PHONE’, ‘ORGANIZATION’,’SSN’, ‘ACCOUNT’, ‘PLATE’, ‘VIN’, ‘LICENSE’, ‘IP’ entities. Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) from sparknlp.pretrained import PretrainedPipeline deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_medium_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; val deid_result = deid_pipeline.fullAnnotate(text) Results | | text | result | result | |---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| | 0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &amp;lt;DOCTOR&amp;gt;, from &amp;lt;HOSPITAL&amp;gt; in &amp;lt;CITY&amp;gt;, attended to the patient on &amp;lt;DATE&amp;gt;.\nThe patient’s medical record number is &amp;lt;IDNUM&amp;gt;.\nThe patient, &amp;lt;PATIENT&amp;gt;, is &amp;lt;AGE&amp;gt;, her Contact number: &amp;lt;PHONE&amp;gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 12/05/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] | | | The patient’s medical record number is 56467890. | | | | | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 . | | | Model Information Model Name: clinical_deidentification_docwise_benchmark_medium_v2 Type: pipeline Compatibility: Healthcare NLP 6.2.2+ License: Licensed Edition: Official Language: en Size: 2.5 GB Included Models DocumentAssembler InternalDocumentSplitter TokenizerModel TokenizerModel WordEmbeddingsModel MedicalNerModel NerConverterInternalModel PretrainedZeroShotNERChunker MedicalNerModel NerConverterInternalModel ChunkMergeModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel ContextualParserModel ContextualParserModel ChunkMergeModel ChunkMergeModel ChunkMergeModel LightDeIdentification LightDeIdentification</summary></entry><entry><title type="html">Clinical Deidentification Pipeline Optimized v2 (Document Wise)</title><link href="/2025/12/14/clinical_deidentification_docwise_benchmark_optimized_v2_en.html" rel="alternate" type="text/html" title="Clinical Deidentification Pipeline Optimized v2 (Document Wise)" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>/2025/12/14/clinical_deidentification_docwise_benchmark_optimized_v2_en</id><content type="html" xml:base="/2025/12/14/clinical_deidentification_docwise_benchmark_optimized_v2_en.html">## Description

This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text.
The pipeline can mask and obfuscate 'NAME','DATE', 'LOCATION', 'PROFESSION', 'DOCTOR', 'EMAIL','PATIENT', 'URL', 'USERNAME',
'CITY', 'COUNTRY', 'DLN', 'HOSPITAL', 'IDNUM', 'MEDICALRECORD', 'STATE', 'STREET', 'ZIP', 'AGE', 'PHONE', 'ORGANIZATION','SSN', 'ACCOUNT',
'PLATE', 'VIN', 'LICENSE', 'IP' entities.

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_optimized_v2_en_6.2.2_3.4_1765742513008.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_benchmark_optimized_v2_en_6.2.2_3.4_1765742513008.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)


```

{:.jsl-block}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

val deid_result = deid_pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash
|    | text                                                                                       | result                                                                                                                                                                                                    | result                                                                                                                                                                                                                                |
|---:|:-------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &lt;DOCTOR&gt;, from &lt;HOSPITAL&gt; in &lt;CITY&gt;, attended to the patient on &lt;DATE&gt;.\nThe patient’s medical record number is &lt;MEDICALRECORD&gt;.\nThe patient, &lt;PATIENT&gt;, is &lt;AGE&gt;, her Contact number: &lt;PHONE&gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 28/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] |
|    | The patient’s medical record number is 56467890.                                           |                                                                                                                                                                                                           |                                                                                                                                                                                                                                       |
|    | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .              |                                                                                                                                                                                                           |                                                                                                                                                                                                                                       |
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|clinical_deidentification_docwise_benchmark_optimized_v2|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|1.8 GB|

## Included Models

- DocumentAssembler
- InternalDocumentSplitter
- TokenizerModel
- TokenizerModel
- WordEmbeddingsModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- ChunkMergeModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- ChunkMergeModel
- ChunkMergeModel
- ChunkMergeModel
- LightDeIdentification
- LightDeIdentification</content><author><name>John Snow Labs</name></author><category term="deidentification" /><category term="deid" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="pipeline" /><category term="docwise" /><summary type="html">Description This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text. The pipeline can mask and obfuscate ‘NAME’,’DATE’, ‘LOCATION’, ‘PROFESSION’, ‘DOCTOR’, ‘EMAIL’,’PATIENT’, ‘URL’, ‘USERNAME’, ‘CITY’, ‘COUNTRY’, ‘DLN’, ‘HOSPITAL’, ‘IDNUM’, ‘MEDICALRECORD’, ‘STATE’, ‘STREET’, ‘ZIP’, ‘AGE’, ‘PHONE’, ‘ORGANIZATION’,’SSN’, ‘ACCOUNT’, ‘PLATE’, ‘VIN’, ‘LICENSE’, ‘IP’ entities. Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) from sparknlp.pretrained import PretrainedPipeline deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_benchmark_optimized_v2&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; val deid_result = deid_pipeline.fullAnnotate(text) Results | | text | result | result | |---:|:-------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| | 0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &amp;lt;DOCTOR&amp;gt;, from &amp;lt;HOSPITAL&amp;gt; in &amp;lt;CITY&amp;gt;, attended to the patient on &amp;lt;DATE&amp;gt;.\nThe patient’s medical record number is &amp;lt;MEDICALRECORD&amp;gt;.\nThe patient, &amp;lt;PATIENT&amp;gt;, is &amp;lt;AGE&amp;gt;, her Contact number: &amp;lt;PHONE&amp;gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 28/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] | | | The patient’s medical record number is 56467890. | | | | | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 . | | | Model Information Model Name: clinical_deidentification_docwise_benchmark_optimized_v2 Type: pipeline Compatibility: Healthcare NLP 6.2.2+ License: Licensed Edition: Official Language: en Size: 1.8 GB Included Models DocumentAssembler InternalDocumentSplitter TokenizerModel TokenizerModel WordEmbeddingsModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel ChunkMergeModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel ContextualParserModel ContextualParserModel ChunkMergeModel ChunkMergeModel ChunkMergeModel LightDeIdentification LightDeIdentification</summary></entry><entry><title type="html">Clinical Deidentification Pipeline Zero Shot Large (Document Wise)</title><link href="/2025/12/14/clinical_deidentification_docwise_zeroshot_large_en.html" rel="alternate" type="text/html" title="Clinical Deidentification Pipeline Zero Shot Large (Document Wise)" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>/2025/12/14/clinical_deidentification_docwise_zeroshot_large_en</id><content type="html" xml:base="/2025/12/14/clinical_deidentification_docwise_zeroshot_large_en.html">## Description

This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text.
The pipeline can mask and obfuscate 'DATE', 'PROFESSION', 'DOCTOR', 'EMAIL','PATIENT', 'URL', 'USERNAME',
'CITY', 'COUNTRY', 'DLN', 'HOSPITAL', 'IDNUM', 'MEDICALRECORD', 'STATE', 'STREET', 'ZIP', 'AGE', 'PHONE', 'ORGANIZATION','SSN', 'ACCOUNT',
'PLATE', 'VIN', 'LICENSE', 'IP' entities.

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_zeroshot_large_en_6.2.2_3.4_1765731123391.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_zeroshot_large_en_6.2.2_3.4_1765731123391.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)


```

{:.jsl-block}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

val deid_result = deid_pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash
|    | text                                                                                       | result                                                                                                                                                                                            | result                                                                                                                                                                                                                                |
|---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &lt;DOCTOR&gt;, from &lt;HOSPITAL&gt; in &lt;CITY&gt;, attended to the patient on &lt;DATE&gt;.\nThe patient’s medical record number is &lt;IDNUM&gt;.\nThe patient, &lt;PATIENT&gt;, is &lt;AGE&gt;, her Contact number: &lt;PHONE&gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 22/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] |
|    | The patient’s medical record number is 56467890.                                           |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
|    | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .              |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|clinical_deidentification_docwise_zeroshot_large|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|1.8 GB|

## Included Models

- DocumentAssembler
- InternalDocumentSplitter
- TokenizerModel
- PretrainedZeroShotNERChunker
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- ChunkMergeModel
- ChunkMergeModel
- ChunkMergeModel
- LightDeIdentification
- LightDeIdentification</content><author><name>John Snow Labs</name></author><category term="deidentification" /><category term="deid" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="pipeline" /><category term="docwise" /><summary type="html">Description This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text. The pipeline can mask and obfuscate ‘DATE’, ‘PROFESSION’, ‘DOCTOR’, ‘EMAIL’,’PATIENT’, ‘URL’, ‘USERNAME’, ‘CITY’, ‘COUNTRY’, ‘DLN’, ‘HOSPITAL’, ‘IDNUM’, ‘MEDICALRECORD’, ‘STATE’, ‘STREET’, ‘ZIP’, ‘AGE’, ‘PHONE’, ‘ORGANIZATION’,’SSN’, ‘ACCOUNT’, ‘PLATE’, ‘VIN’, ‘LICENSE’, ‘IP’ entities. Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) from sparknlp.pretrained import PretrainedPipeline deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_large&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; val deid_result = deid_pipeline.fullAnnotate(text) Results | | text | result | result | |---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| | 0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &amp;lt;DOCTOR&amp;gt;, from &amp;lt;HOSPITAL&amp;gt; in &amp;lt;CITY&amp;gt;, attended to the patient on &amp;lt;DATE&amp;gt;.\nThe patient’s medical record number is &amp;lt;IDNUM&amp;gt;.\nThe patient, &amp;lt;PATIENT&amp;gt;, is &amp;lt;AGE&amp;gt;, her Contact number: &amp;lt;PHONE&amp;gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 22/06/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] | | | The patient’s medical record number is 56467890. | | | | | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 . | | | Model Information Model Name: clinical_deidentification_docwise_zeroshot_large Type: pipeline Compatibility: Healthcare NLP 6.2.2+ License: Licensed Edition: Official Language: en Size: 1.8 GB Included Models DocumentAssembler InternalDocumentSplitter TokenizerModel PretrainedZeroShotNERChunker ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel ContextualParserModel ContextualParserModel ChunkMergeModel ChunkMergeModel ChunkMergeModel LightDeIdentification LightDeIdentification</summary></entry><entry><title type="html">Clinical Deidentification Pipeline Zero Shot Medium (Document Wise)</title><link href="/2025/12/14/clinical_deidentification_docwise_zeroshot_medium_en.html" rel="alternate" type="text/html" title="Clinical Deidentification Pipeline Zero Shot Medium (Document Wise)" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>/2025/12/14/clinical_deidentification_docwise_zeroshot_medium_en</id><content type="html" xml:base="/2025/12/14/clinical_deidentification_docwise_zeroshot_medium_en.html">## Description

This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text.
The pipeline can mask and obfuscate 'DATE', 'PROFESSION', 'DOCTOR', 'EMAIL','PATIENT', 'URL', 'USERNAME',
'CITY', 'COUNTRY', 'DLN', 'HOSPITAL', 'IDNUM', 'MEDICALRECORD', 'STATE', 'STREET', 'ZIP', 'AGE', 'PHONE', 'ORGANIZATION','SSN', 'ACCOUNT',
'PLATE', 'VIN', 'LICENSE', 'IP' entities.

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_zeroshot_medium_en_6.2.2_3.4_1765730992871.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/clinical_deidentification_docwise_zeroshot_medium_en_6.2.2_3.4_1765730992871.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)


```

{:.jsl-block}
```python

from sparknlp.pretrained import PretrainedPipeline

deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

deid_result = deid_pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024.
The patient’s medical record number is 56467890.
The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot;

val deid_result = deid_pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash
|    | text                                                                                       | result                                                                                                                                                                                            | result                                                                                                                                                                                                                                |
|---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &lt;DOCTOR&gt;, from &lt;HOSPITAL&gt; in &lt;CITY&gt;, attended to the patient on &lt;DATE&gt;.\nThe patient’s medical record number is &lt;IDNUM&gt;.\nThe patient, &lt;PATIENT&gt;, is &lt;AGE&gt;, her Contact number: &lt;PHONE&gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 05/07/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] |
|    | The patient’s medical record number is 56467890.                                           |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
|    | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .              |                                                                                                                                                                                                   |                                                                                                                                                                                                                                       |
```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|clinical_deidentification_docwise_zeroshot_medium|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|791.2 MB|

## Included Models

- DocumentAssembler
- InternalDocumentSplitter
- TokenizerModel
- PretrainedZeroShotNERChunker
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- RegexMatcherInternalModel
- ContextualParserModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ContextualParserModel
- ContextualParserModel
- ChunkMergeModel
- ChunkMergeModel
- ChunkMergeModel
- LightDeIdentification
- LightDeIdentification</content><author><name>John Snow Labs</name></author><category term="deidentification" /><category term="deid" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="pipeline" /><category term="docwise" /><summary type="html">Description This pipeline can be used to deidentify PHI information from medical texts. The PHI information will be masked and obfuscated in the resulting text. The pipeline can mask and obfuscate ‘DATE’, ‘PROFESSION’, ‘DOCTOR’, ‘EMAIL’,’PATIENT’, ‘URL’, ‘USERNAME’, ‘CITY’, ‘COUNTRY’, ‘DLN’, ‘HOSPITAL’, ‘IDNUM’, ‘MEDICALRECORD’, ‘STATE’, ‘STREET’, ‘ZIP’, ‘AGE’, ‘PHONE’, ‘ORGANIZATION’,’SSN’, ‘ACCOUNT’, ‘PLATE’, ‘VIN’, ‘LICENSE’, ‘IP’ entities. Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) from sparknlp.pretrained import PretrainedPipeline deid_pipeline = nlp.PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; deid_result = deid_pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val deid_pipeline = PretrainedPipeline(&quot;clinical_deidentification_docwise_zeroshot_medium&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. The patient’s medical record number is 56467890. The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 .&quot;&quot;&quot; val deid_result = deid_pipeline.fullAnnotate(text) Results | | text | result | result | |---:|:-------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| | 0 | Dr. John Lee, from Royal Medical Clinic in Chicago, attended to the patient on 11/05/2024. | ['Dr. &amp;lt;DOCTOR&amp;gt;, from &amp;lt;HOSPITAL&amp;gt; in &amp;lt;CITY&amp;gt;, attended to the patient on &amp;lt;DATE&amp;gt;.\nThe patient’s medical record number is &amp;lt;IDNUM&amp;gt;.\nThe patient, &amp;lt;PATIENT&amp;gt;, is &amp;lt;AGE&amp;gt;, her Contact number: &amp;lt;PHONE&amp;gt; .'] | ['Dr. Valerie Aho, from Mercy Hospital Aurora in Berea, attended to the patient on 05/07/2024.\nThe patient’s medical record number is 78689012.\nThe patient, Johnathon Bunde, is 55 years old, her Contact number: 666-678-9012 .'] | | | The patient’s medical record number is 56467890. | | | | | The patient, Emma Wilson, is 50 years old, her Contact number: 444-456-7890 . | | | Model Information Model Name: clinical_deidentification_docwise_zeroshot_medium Type: pipeline Compatibility: Healthcare NLP 6.2.2+ License: Licensed Edition: Official Language: en Size: 791.2 MB Included Models DocumentAssembler InternalDocumentSplitter TokenizerModel PretrainedZeroShotNERChunker ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel ContextualParserModel RegexMatcherInternalModel RegexMatcherInternalModel RegexMatcherInternalModel ContextualParserModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel ContextualParserModel ContextualParserModel ChunkMergeModel ChunkMergeModel ChunkMergeModel LightDeIdentification LightDeIdentification</summary></entry><entry><title type="html">Sentence Entity Resolver for CPT Codes (bge_base_en_v1_5_onnx)</title><link href="/2025/12/05/bgeresolve_cpt_en.html" rel="alternate" type="text/html" title="Sentence Entity Resolver for CPT Codes (bge_base_en_v1_5_onnx)" /><published>2025-12-05T00:00:00+00:00</published><updated>2025-12-05T00:00:00+00:00</updated><id>/2025/12/05/bgeresolve_cpt_en</id><content type="html" xml:base="/2025/12/05/bgeresolve_cpt_en.html">## Description

This model maps clinical entities (Observation, Procedures, Tests, Treatments, Drug) to their corresponding CPT (Current Procedural Terminology) codes using `bge_base_en_v1_5_onnx` embeddings. It uses `bge_base_en_v1_5_onnx` embeddings and provides multiple resolution candidates with confidence scores, making it ideal for accurate procedural code assignment in clinical documentation.

## Predicted Entities

`CPT Codes`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/bgeresolve_cpt_en_6.2.0_3.4_1764900772092.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/bgeresolve_cpt_en_6.2.0_3.4_1764900772092.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_model_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;])

chunk2doc = Chunk2Doc()\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;ner_chunk_doc&quot;)

bge_embeddings = BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;)\
    .setInputCols([&quot;ner_chunk_doc&quot;])\
    .setOutputCol(&quot;bge_embeddings&quot;)

cpt_resolver = SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;)\
    .setInputCols([&quot;bge_embeddings&quot;])\
    .setOutputCol(&quot;cpt_code&quot;)\
    .setDistanceFunction(&quot;EUCLIDEAN&quot;)

pipeline = Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_model_converter,
    chunk2doc,
    bge_embeddings,
    cpt_resolver
])

text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_model_converter = medical.NerConverter()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;])

chunk2doc = nlp.Chunk2Doc()\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;ner_chunk_doc&quot;)

bge_embeddings = nlp.BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;)\
    .setInputCols([&quot;ner_chunk_doc&quot;])\
    .setOutputCol(&quot;bge_embeddings&quot;)

cpt_resolver = medical.SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;)\
    .setInputCols([&quot;bge_embeddings&quot;])\
    .setOutputCol(&quot;cpt_code&quot;)\
    .setDistanceFunction(&quot;EUCLIDEAN&quot;)

pipeline = nlp.Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_model_converter,
    chunk2doc,
    bge_embeddings,
    cpt_resolver
])

text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentence&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentence&quot;))
    .setOutputCol(&quot;token&quot;)

val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;ner&quot;)

val nerModelConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;))
    .setOutputCol(&quot;ner_chunk&quot;)
    .setWhiteList(Array(&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;))

val chunk2doc = new Chunk2Doc()
    .setInputCols(Array(&quot;ner_chunk&quot;))
    .setOutputCol(&quot;ner_chunk_doc&quot;)

val bgeEmbeddings = BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;)
    .setInputCols(Array(&quot;ner_chunk_doc&quot;))
    .setOutputCol(&quot;bge_embeddings&quot;)

val cptResolver = SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;)
    .setInputCols(Array(&quot;bge_embeddings&quot;))
    .setOutputCol(&quot;cpt_code&quot;)
    .setDistanceFunction(&quot;EUCLIDEAN&quot;)

val pipeline = new Pipeline().setStages(Array(
    documentAssembler,
    sentenceDetector,
    tokenizer,
    wordEmbeddings,
    nerModel,
    nerModelConverter,
    chunk2doc,
    bgeEmbeddings,
    cptResolver
))

val data = Seq(&quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;).toDF(&quot;text&quot;)

val result = pipeline.fit(data).transform(data)

```
&lt;/div&gt;

## Results

```bash

|sent_id|ner_chunk         |entity       |cpt_code|resolutions       |all_codes                                              |all_resolutions                                                                                                              |
|-------|------------------|-------------|--------|------------------|-------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
|0      |episiotomy        |Procedure    |59300   |episiotomy        |[59300, 59409, 59410, 59614, 59612, 59610, 100...]     |[episiotomy, vaginal delivery with episiotomy, ...]                                                                          |
|1      |Pulse oximetry    |Test         |94760   |pulse oximetry    |[94760, 99453, 94761, 82810, 94762, 1013256, 8...]     |[pulse oximetry, device pulse oximetry, noninvasive ear or pulse oximetry for oxygen saturation single determination, ...]   |
|2      |blood transfusion |Procedure    |36430   |blood transfusion |[36430, 86950, 38243, 36450, 0232T, 36460, 382...]     |[blood transfusion, white blood cell transfusion, ...]                                                                       |
|3      |inpatient hospital|Clinical_Dept|1021881 |inpatient hospital|[1021881, 94003, 1021895, 99236, 1013660, 1013...]     |[inpatient hospital, inpatient care, inpatient hospital care, ...]                                                           |

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|bgeresolve_cpt|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[bge_embeddings]|
|Output Labels:|[cpt_code]|
|Language:|en|
|Size:|388.0 MB|
|Case sensitive:|false|

## References

**CPT resolver models are removed from the Models Hub due to license restrictions and can only be shared with the users who already have a valid CPT license. If you possess one and wish to use this model, kindly contact us at support@johnsnowlabs.com.**</content><author><name>John Snow Labs</name></author><category term="resolver" /><category term="cpt" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="bge" /><category term="sentence_embeddings" /><summary type="html">Description This model maps clinical entities (Observation, Procedures, Tests, Treatments, Drug) to their corresponding CPT (Current Procedural Terminology) codes using bge_base_en_v1_5_onnx embeddings. It uses bge_base_en_v1_5_onnx embeddings and provides multiple resolution candidates with confidence scores, making it ideal for accurate procedural code assignment in clinical documentation. Predicted Entities CPT Codes Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_model_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;]) chunk2doc = Chunk2Doc()\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;ner_chunk_doc&quot;) bge_embeddings = BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;)\ .setInputCols([&quot;ner_chunk_doc&quot;])\ .setOutputCol(&quot;bge_embeddings&quot;) cpt_resolver = SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;)\ .setInputCols([&quot;bge_embeddings&quot;])\ .setOutputCol(&quot;cpt_code&quot;)\ .setDistanceFunction(&quot;EUCLIDEAN&quot;) pipeline = Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_model_converter, chunk2doc, bge_embeddings, cpt_resolver ]) text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_model_converter = medical.NerConverter()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;]) chunk2doc = nlp.Chunk2Doc()\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;ner_chunk_doc&quot;) bge_embeddings = nlp.BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;)\ .setInputCols([&quot;ner_chunk_doc&quot;])\ .setOutputCol(&quot;bge_embeddings&quot;) cpt_resolver = medical.SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;)\ .setInputCols([&quot;bge_embeddings&quot;])\ .setOutputCol(&quot;cpt_code&quot;)\ .setDistanceFunction(&quot;EUCLIDEAN&quot;) pipeline = nlp.Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_model_converter, chunk2doc, bge_embeddings, cpt_resolver ]) text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentence&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentence&quot;)) .setOutputCol(&quot;token&quot;) val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;ner&quot;) val nerModelConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)) .setOutputCol(&quot;ner_chunk&quot;) .setWhiteList(Array(&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;)) val chunk2doc = new Chunk2Doc() .setInputCols(Array(&quot;ner_chunk&quot;)) .setOutputCol(&quot;ner_chunk_doc&quot;) val bgeEmbeddings = BGEEmbeddings.pretrained(&quot;bge_base_en_v1_5_onnx&quot;, &quot;en&quot;) .setInputCols(Array(&quot;ner_chunk_doc&quot;)) .setOutputCol(&quot;bge_embeddings&quot;) val cptResolver = SentenceEntityResolverModel.load(&quot;bgeresolve_cpt&quot;) .setInputCols(Array(&quot;bge_embeddings&quot;)) .setOutputCol(&quot;cpt_code&quot;) .setDistanceFunction(&quot;EUCLIDEAN&quot;) val pipeline = new Pipeline().setStages(Array( documentAssembler, sentenceDetector, tokenizer, wordEmbeddings, nerModel, nerModelConverter, chunk2doc, bgeEmbeddings, cptResolver )) val data = Seq(&quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;).toDF(&quot;text&quot;) val result = pipeline.fit(data).transform(data) Results |sent_id|ner_chunk |entity |cpt_code|resolutions |all_codes |all_resolutions | |-------|------------------|-------------|--------|------------------|-------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------| |0 |episiotomy |Procedure |59300 |episiotomy |[59300, 59409, 59410, 59614, 59612, 59610, 100...] |[episiotomy, vaginal delivery with episiotomy, ...] | |1 |Pulse oximetry |Test |94760 |pulse oximetry |[94760, 99453, 94761, 82810, 94762, 1013256, 8...] |[pulse oximetry, device pulse oximetry, noninvasive ear or pulse oximetry for oxygen saturation single determination, ...] | |2 |blood transfusion |Procedure |36430 |blood transfusion |[36430, 86950, 38243, 36450, 0232T, 36460, 382...] |[blood transfusion, white blood cell transfusion, ...] | |3 |inpatient hospital|Clinical_Dept|1021881 |inpatient hospital|[1021881, 94003, 1021895, 99236, 1013660, 1013...] |[inpatient hospital, inpatient care, inpatient hospital care, ...] | Model Information Model Name: bgeresolve_cpt Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [bge_embeddings] Output Labels: [cpt_code] Language: en Size: 388.0 MB Case sensitive: false References CPT resolver models are removed from the Models Hub due to license restrictions and can only be shared with the users who already have a valid CPT license. If you possess one and wish to use this model, kindly contact us at support@johnsnowlabs.com.</summary></entry><entry><title type="html">Mapping Entities with Corresponding CPT Codes</title><link href="/2025/12/05/cpt_mapper_en.html" rel="alternate" type="text/html" title="Mapping Entities with Corresponding CPT Codes" /><published>2025-12-05T00:00:00+00:00</published><updated>2025-12-05T00:00:00+00:00</updated><id>/2025/12/05/cpt_mapper_en</id><content type="html" xml:base="/2025/12/05/cpt_mapper_en.html">## Description

This model maps clinical entities (procedures, tests, treatments) to their corresponding CPT (Current Procedural Terminology) codes. It provides fast and accurate procedural code mapping without requiring embeddings.

## Predicted Entities

`CPT Codes`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/cpt_mapper_en_6.2.0_3.4_1764898398392.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/cpt_mapper_en_6.2.0_3.4_1764898398392.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_model_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;])

cpt_mapper = ChunkMapperModel.load(&quot;cpt_mapper&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;cpt_code&quot;])\
    .setLowerCase(True)

pipeline = Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_model_converter,
    cpt_mapper
])

text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_model_converter = medical.NerConverter()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;])

cpt_mapper = medical.ChunkMapperModel.load(&quot;cpt_mapper&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;cpt_code&quot;])\
    .setLowerCase(True)

pipeline = nlp.Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_model_converter,
    cpt_mapper
])

text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentence&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentence&quot;))
    .setOutputCol(&quot;token&quot;)

val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;ner&quot;)

val nerModelConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;))
    .setOutputCol(&quot;ner_chunk&quot;)
    .setWhiteList(Array(&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;))

val cptMapper = ChunkMapperModel.load(&quot;cpt_mapper&quot;)
    .setInputCols(Array(&quot;ner_chunk&quot;))
    .setOutputCol(&quot;mappings&quot;)
    .setRels(Array(&quot;cpt_code&quot;))
    .setLowerCase(true)

val pipeline = new Pipeline().setStages(Array(
    documentAssembler,
    sentenceDetector,
    tokenizer,
    wordEmbeddings,
    nerModel,
    nerModelConverter,
    cptMapper
))

val data = Seq(&quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;).toDF(&quot;text&quot;)

val result = pipeline.fit(data).transform(data)

```
&lt;/div&gt;

## Results

```bash

|ner_chunk         |mapping_result|
|------------------|--------------|
|episiotomy        |59300         |
|Pulse oximetry    |94760         |
|blood transfusion |36430         |
|inpatient hospital|1021881       |

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|cpt_mapper|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[ner_chunk]|
|Output Labels:|[mappings]|
|Language:|en|
|Size:|5.1 MB|

## References

**CPT resolver models are removed from the Models Hub due to license restrictions and can only be shared with the users who already have a valid CPT license. If you possess one and wish to use this model, kindly contact us at support@johnsnowlabs.com.**</content><author><name>John Snow Labs</name></author><category term="mapper" /><category term="cpt" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="chunk_mapper" /><summary type="html">Description This model maps clinical entities (procedures, tests, treatments) to their corresponding CPT (Current Procedural Terminology) codes. It provides fast and accurate procedural code mapping without requiring embeddings. Predicted Entities CPT Codes Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_model_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;]) cpt_mapper = ChunkMapperModel.load(&quot;cpt_mapper&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;cpt_code&quot;])\ .setLowerCase(True) pipeline = Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_model_converter, cpt_mapper ]) text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_model_converter = medical.NerConverter()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;]) cpt_mapper = medical.ChunkMapperModel.load(&quot;cpt_mapper&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;cpt_code&quot;])\ .setLowerCase(True) pipeline = nlp.Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_model_converter, cpt_mapper ]) text = &quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentence&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentence&quot;)) .setOutputCol(&quot;token&quot;) val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerModel = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;ner&quot;) val nerModelConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)) .setOutputCol(&quot;ner_chunk&quot;) .setWhiteList(Array(&quot;Procedure&quot;, &quot;Test&quot;, &quot;Treatment&quot;, &quot;Clinical_Dept&quot;)) val cptMapper = ChunkMapperModel.load(&quot;cpt_mapper&quot;) .setInputCols(Array(&quot;ner_chunk&quot;)) .setOutputCol(&quot;mappings&quot;) .setRels(Array(&quot;cpt_code&quot;)) .setLowerCase(true) val pipeline = new Pipeline().setStages(Array( documentAssembler, sentenceDetector, tokenizer, wordEmbeddings, nerModel, nerModelConverter, cptMapper )) val data = Seq(&quot;&quot;&quot;A 28-year-old female underwent episiotomy during vaginal delivery. Pulse oximetry was monitored continuously throughout the procedure. Due to postpartum hemorrhage, blood transfusion was administered. The patient was transferred to the inpatient hospital for overnight observation.&quot;&quot;&quot;).toDF(&quot;text&quot;) val result = pipeline.fit(data).transform(data) Results |ner_chunk |mapping_result| |------------------|--------------| |episiotomy |59300 | |Pulse oximetry |94760 | |blood transfusion |36430 | |inpatient hospital|1021881 | Model Information Model Name: cpt_mapper Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [ner_chunk] Output Labels: [mappings] Language: en Size: 5.1 MB References CPT resolver models are removed from the Models Hub due to license restrictions and can only be shared with the users who already have a valid CPT license. If you possess one and wish to use this model, kindly contact us at support@johnsnowlabs.com.</summary></entry><entry><title type="html">Mapping Entities with Corresponding SNOMED Codes</title><link href="/2025/12/05/snomed_mapper_en.html" rel="alternate" type="text/html" title="Mapping Entities with Corresponding SNOMED Codes" /><published>2025-12-05T00:00:00+00:00</published><updated>2025-12-05T00:00:00+00:00</updated><id>/2025/12/05/snomed_mapper_en</id><content type="html" xml:base="/2025/12/05/snomed_mapper_en.html">## Description

This model maps clinical entities to their corresponding SNOMED codes. It provides fast and accurate clinical code mapping without requiring embeddings.

## Predicted Entities

`SNOMED Codes`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/snomed_mapper_en_6.2.0_3.4_1764895840867.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/snomed_mapper_en_6.2.0_3.4_1764895840867.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_jsl = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner_jsl&quot;)

ner_jsl_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;,
                   &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;,
                   &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;,
                   &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;,
                   &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;,
                   &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;,
                   &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;])

snomed_mapper = ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;snomed_code&quot;])

pipeline = Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_jsl,
    ner_jsl_converter,
    snomed_mapper
])

text = &quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_jsl = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner_jsl&quot;)

ner_jsl_converter = medical.NerConverter()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;,
                   &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;,
                   &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;,
                   &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;,
                   &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;,
                   &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;,
                   &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;])

snomed_mapper = medical.ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;snomed_code&quot;])

pipeline = nlp.Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_jsl,
    ner_jsl_converter,
    snomed_mapper
])

text = &quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentence&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentence&quot;))
    .setOutputCol(&quot;token&quot;)

val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerJsl = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;ner_jsl&quot;)

val nerJslConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;))
    .setOutputCol(&quot;ner_chunk&quot;)
    .setWhiteList(Array(&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;,
                        &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;,
                        &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;,
                        &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;,
                        &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;,
                        &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;,
                        &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;))

val snomedMapper = ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;ner_chunk&quot;))
    .setOutputCol(&quot;mappings&quot;)
    .setRels(Array(&quot;snomed_code&quot;))

val pipeline = new Pipeline().setStages(Array(
    documentAssembler,
    sentenceDetector,
    tokenizer,
    wordEmbeddings,
    nerJsl,
    nerJslConverter,
    snomedMapper
))

val data = Seq(&quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot;).toDF(&quot;text&quot;)

val result = pipeline.fit(data).transform(data)

```
&lt;/div&gt;

## Results

```bash

|ner_chunk        |mapping_result|
|-----------------|--------------|
|ofloxacin        |387551000     |
|secondary        |2603003       |
|conjunctivitis   |9826008       |
|cefixime         |387536009     |
|cystic urethritis|1259233009    |
|ibuprofen        |387207008     |
|inflammation     |257552002     |
|cilnidipine      |1177123004    |
|hypertension     |38341003      |

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|snomed_mapper|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[ner_chunk]|
|Output Labels:|[mappings]|
|Language:|en|
|Size:|26.6 MB|</content><author><name>John Snow Labs</name></author><category term="mapper" /><category term="snomed" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="chunk_mapper" /><summary type="html">Description This model maps clinical entities to their corresponding SNOMED codes. It provides fast and accurate clinical code mapping without requiring embeddings. Predicted Entities SNOMED Codes Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_jsl = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner_jsl&quot;) ner_jsl_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;, &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;, &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;, &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;, &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;, &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;, &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;]) snomed_mapper = ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;snomed_code&quot;]) pipeline = Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_jsl, ner_jsl_converter, snomed_mapper ]) text = &quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_jsl = medical.NerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner_jsl&quot;) ner_jsl_converter = medical.NerConverter()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;])\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;, &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;, &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;, &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;, &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;, &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;, &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;]) snomed_mapper = medical.ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;snomed_code&quot;]) pipeline = nlp.Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_jsl, ner_jsl_converter, snomed_mapper ]) text = &quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentence&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentence&quot;)) .setOutputCol(&quot;token&quot;) val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerJsl = MedicalNerModel.pretrained(&quot;ner_jsl&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;ner_jsl&quot;) val nerJslConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_jsl&quot;)) .setOutputCol(&quot;ner_chunk&quot;) .setWhiteList(Array(&quot;Procedure&quot;,&quot;Kidney_Disease&quot;,&quot;Cerebrovascular_Disease&quot;,&quot;Heart_Disease&quot;, &quot;Disease_Syndrome_Disorder&quot;, &quot;ImagingFindings&quot;, &quot;Symptom&quot;, &quot;VS_Finding&quot;, &quot;EKG_Findings&quot;, &quot;Communicable_Disease&quot;,&quot;Substance&quot;,&quot;Drug_Ingredient&quot;, &quot;Internal_organ_or_component&quot;, &quot;External_body_part_or_region&quot;, &quot;Modifier&quot;, &quot;Triglycerides&quot;, &quot;Alcohol&quot;, &quot;Smoking&quot;, &quot;Hypertension&quot;, &quot;Obesity&quot;, &quot;Injury_or_Poisoning&quot;,&quot;Test&quot;,&quot;Hyperlipidemia&quot;,&quot;BMI&quot;,&quot;Oncological&quot;, &quot;Psychological_Condition&quot;, &quot;LDL&quot;, &quot;Diabetes&quot;)) val snomedMapper = ChunkMapperModel.pretrained(&quot;snomed_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;ner_chunk&quot;)) .setOutputCol(&quot;mappings&quot;) .setRels(Array(&quot;snomed_code&quot;)) val pipeline = new Pipeline().setStages(Array( documentAssembler, sentenceDetector, tokenizer, wordEmbeddings, nerJsl, nerJslConverter, snomedMapper )) val data = Seq(&quot;&quot;&quot;John's doctor prescribed ofloxacin for his secondary conjunctivitis, cefixime for his cystic urethritis, ibuprofen for his inflammation, and cilnidipine for his hypertension on 2023-12-01.&quot;&quot;&quot;).toDF(&quot;text&quot;) val result = pipeline.fit(data).transform(data) Results |ner_chunk |mapping_result| |-----------------|--------------| |ofloxacin |387551000 | |secondary |2603003 | |conjunctivitis |9826008 | |cefixime |387536009 | |cystic urethritis|1259233009 | |ibuprofen |387207008 | |inflammation |257552002 | |cilnidipine |1177123004 | |hypertension |38341003 | Model Information Model Name: snomed_mapper Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [ner_chunk] Output Labels: [mappings] Language: en Size: 26.6 MB</summary></entry><entry><title type="html">Mapping Entities with Corresponding ICD-10-CM Codes</title><link href="/2025/12/04/icd10cm_mapper_en.html" rel="alternate" type="text/html" title="Mapping Entities with Corresponding ICD-10-CM Codes" /><published>2025-12-04T00:00:00+00:00</published><updated>2025-12-04T00:00:00+00:00</updated><id>/2025/12/04/icd10cm_mapper_en</id><content type="html" xml:base="/2025/12/04/icd10cm_mapper_en.html">## Description

This model maps clinical entities to their corresponding ICD-10-CM codes. It provides fast and accurate clinical code mapping without requiring embeddings.

## Predicted Entities

`ICD-10-CM Codes`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/icd10cm_mapper_en_6.2.0_3.4_1764891297647.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/icd10cm_mapper_en_6.2.0_3.4_1764891297647.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols(&quot;sentence&quot;)\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = MedicalNerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;PROBLEM&quot;])

icd10cm_mapper = ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;icd10cm_code&quot;])

pipeline = Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_converter,
    icd10cm_mapper
])

text = &quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols(&quot;sentence&quot;)\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_model = medical.NerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverter()\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;PROBLEM&quot;])

icd10cm_mapper = medical.ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;icd10cm_code&quot;])

pipeline = nlp.Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_model,
    ner_converter,
    icd10cm_mapper
])

text = &quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentence&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentence&quot;))
    .setOutputCol(&quot;token&quot;)

val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerModel = MedicalNerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;ner&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;))
    .setOutputCol(&quot;ner_chunk&quot;)
    .setWhiteList(Array(&quot;PROBLEM&quot;))

val icd10cmMapper = ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;ner_chunk&quot;))
    .setOutputCol(&quot;mappings&quot;)
    .setRels(Array(&quot;icd10cm_code&quot;))

val pipeline = new Pipeline().setStages(Array(
    documentAssembler,
    sentenceDetector,
    tokenizer,
    wordEmbeddings,
    nerModel,
    nerConverter,
    icd10cmMapper
))

val data = Seq(&quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot;).toDF(&quot;text&quot;)

val result = pipeline.fit(data).transform(data)

```
&lt;/div&gt;

## Results

```bash

|ner_chunk             |mapping_result|
|----------------------|--------------|
|sciatica              |M54.3         |
|myalgia               |M79.1         |
|polymyositis          |M33.2         |
|glossitis             |K14.0         |
|beriberi              |E51.1         |
|nutritional deficiency|E63.9         |
|spondylolysis         |M43.0         |
|motion sickness       |T75.3         |

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|icd10cm_mapper|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[ner_chunk]|
|Output Labels:|[mappings]|
|Language:|en|
|Size:|24.3 MB|</content><author><name>John Snow Labs</name></author><category term="mapper" /><category term="icd10cm" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="chunk_mapper" /><summary type="html">Description This model maps clinical entities to their corresponding ICD-10-CM codes. It provides fast and accurate clinical code mapping without requiring embeddings. Predicted Entities ICD-10-CM Codes Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols(&quot;sentence&quot;)\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = MedicalNerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;PROBLEM&quot;]) icd10cm_mapper = ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;icd10cm_code&quot;]) pipeline = Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_converter, icd10cm_mapper ]) text = &quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols(&quot;sentence&quot;)\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_model = medical.NerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverter()\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;PROBLEM&quot;]) icd10cm_mapper = medical.ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;icd10cm_code&quot;]) pipeline = nlp.Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_model, ner_converter, icd10cm_mapper ]) text = &quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = SentenceDetectorDLModel.pretrained(&quot;sentence_detector_dl_healthcare&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentence&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentence&quot;)) .setOutputCol(&quot;token&quot;) val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerModel = MedicalNerModel.pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;ner&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;)) .setOutputCol(&quot;ner_chunk&quot;) .setWhiteList(Array(&quot;PROBLEM&quot;)) val icd10cmMapper = ChunkMapperModel.pretrained(&quot;icd10cm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;ner_chunk&quot;)) .setOutputCol(&quot;mappings&quot;) .setRels(Array(&quot;icd10cm_code&quot;)) val pipeline = new Pipeline().setStages(Array( documentAssembler, sentenceDetector, tokenizer, wordEmbeddings, nerModel, nerConverter, icd10cmMapper )) val data = Seq(&quot;&quot;&quot;A 58-year-old male presents with sciatica and myalgia affecting his lower extremities. He has a history of polymyositis, currently managed with medication. The patient also reports glossitis and beriberi due to nutritional deficiency. Recently, he developed spondylolysis and experiences motion sickness during travel.&quot;&quot;&quot;).toDF(&quot;text&quot;) val result = pipeline.fit(data).transform(data) Results |ner_chunk |mapping_result| |----------------------|--------------| |sciatica |M54.3 | |myalgia |M79.1 | |polymyositis |M33.2 | |glossitis |K14.0 | |beriberi |E51.1 | |nutritional deficiency|E63.9 | |spondylolysis |M43.0 | |motion sickness |T75.3 | Model Information Model Name: icd10cm_mapper Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [ner_chunk] Output Labels: [mappings] Language: en Size: 24.3 MB</summary></entry><entry><title type="html">Mapping Entities with Corresponding RxNorm Codes</title><link href="/2025/12/04/rxnorm_mapper_en.html" rel="alternate" type="text/html" title="Mapping Entities with Corresponding RxNorm Codes" /><published>2025-12-04T00:00:00+00:00</published><updated>2025-12-04T00:00:00+00:00</updated><id>/2025/12/04/rxnorm_mapper_en</id><content type="html" xml:base="/2025/12/04/rxnorm_mapper_en.html">## Description

This model maps drug entities to their corresponding RxNorm codes. It provides fast and accurate drug code mapping without requiring embeddings.

## Predicted Entities

`RxNorm Codes`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/rxnorm_mapper_en_6.2.0_3.4_1764808728293.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/rxnorm_mapper_en_6.2.0_3.4_1764808728293.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols(&quot;sentence&quot;)\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_posology = MedicalNerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;posology_ner&quot;)

ner_posology_converter = NerConverterInternal()\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;)\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;DRUG&quot;])

rxnorm_mapper = ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;rxnorm_code&quot;])

pipeline = Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_posology,
    ner_posology_converter,
    rxnorm_mapper
])

text = &quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols(&quot;sentence&quot;)\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

ner_posology = medical.NerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;posology_ner&quot;)

ner_posology_converter = medical.NerConverter()\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;)\
    .setOutputCol(&quot;ner_chunk&quot;)\
    .setWhiteList([&quot;DRUG&quot;])

rxnorm_mapper = medical.ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;ner_chunk&quot;])\
    .setOutputCol(&quot;mappings&quot;)\
    .setRels([&quot;rxnorm_code&quot;])

pipeline = nlp.Pipeline().setStages([
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    ner_posology,
    ner_posology_converter,
    rxnorm_mapper
])

text = &quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot;

data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;)

result = pipeline.fit(data).transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentence&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentence&quot;))
    .setOutputCol(&quot;token&quot;)

val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerPosology = MedicalNerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;posology_ner&quot;)

val nerPosologyConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;))
    .setOutputCol(&quot;ner_chunk&quot;)
    .setWhiteList(Array(&quot;DRUG&quot;))

val rxnormMapper = ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;ner_chunk&quot;))
    .setOutputCol(&quot;mappings&quot;)
    .setRels(Array(&quot;rxnorm_code&quot;))

val pipeline = new Pipeline().setStages(Array(
    documentAssembler,
    sentenceDetector,
    tokenizer,
    wordEmbeddings,
    nerPosology,
    nerPosologyConverter,
    rxnormMapper
))

val data = Seq(&quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot;).toDF(&quot;text&quot;)

val result = pipeline.fit(data).transform(data)

```
&lt;/div&gt;

## Results

```bash

|ner_chunk                |mapping_result|
|-------------------------|--------------|
|ibuprofen topical cream  |377732        |
|selenium sulfide 25 mg/ml|328880        |
|salicylamide 250 mg      |316651        |

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|rxnorm_mapper|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[ner_chunk]|
|Output Labels:|[mappings]|
|Language:|en|
|Size:|10.4 MB|</content><author><name>John Snow Labs</name></author><category term="mapper" /><category term="rxnorm" /><category term="en" /><category term="licensed" /><category term="clinical" /><category term="chunk_mapper" /><summary type="html">Description This model maps drug entities to their corresponding RxNorm codes. It provides fast and accurate drug code mapping without requiring embeddings. Predicted Entities RxNorm Codes Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols(&quot;sentence&quot;)\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_posology = MedicalNerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;posology_ner&quot;) ner_posology_converter = NerConverterInternal()\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;)\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;DRUG&quot;]) rxnorm_mapper = ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;rxnorm_code&quot;]) pipeline = Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_posology, ner_posology_converter, rxnorm_mapper ]) text = &quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols(&quot;sentence&quot;)\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) ner_posology = medical.NerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;posology_ner&quot;) ner_posology_converter = medical.NerConverter()\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;)\ .setOutputCol(&quot;ner_chunk&quot;)\ .setWhiteList([&quot;DRUG&quot;]) rxnorm_mapper = medical.ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;ner_chunk&quot;])\ .setOutputCol(&quot;mappings&quot;)\ .setRels([&quot;rxnorm_code&quot;]) pipeline = nlp.Pipeline().setStages([ document_assembler, sentence_detector, tokenizer, word_embeddings, ner_posology, ner_posology_converter, rxnorm_mapper ]) text = &quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF(&quot;text&quot;) result = pipeline.fit(data).transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentence&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentence&quot;)) .setOutputCol(&quot;token&quot;) val wordEmbeddings = WordEmbeddingsModel.pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerPosology = MedicalNerModel.pretrained(&quot;ner_posology_greedy&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;posology_ner&quot;) val nerPosologyConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentence&quot;, &quot;token&quot;, &quot;posology_ner&quot;)) .setOutputCol(&quot;ner_chunk&quot;) .setWhiteList(Array(&quot;DRUG&quot;)) val rxnormMapper = ChunkMapperModel.pretrained(&quot;rxnorm_mapper&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;ner_chunk&quot;)) .setOutputCol(&quot;mappings&quot;) .setRels(Array(&quot;rxnorm_code&quot;)) val pipeline = new Pipeline().setStages(Array( documentAssembler, sentenceDetector, tokenizer, wordEmbeddings, nerPosology, nerPosologyConverter, rxnormMapper )) val data = Seq(&quot;&quot;&quot;The patient reported persistent musculoskeletal discomfort, for which ibuprofen topical cream was initiated. Due to concurrent scalp irritation, selenium sulfide 25 mg/ml was also prescribed, and salicylamide 250 mg was added for additional symptomatic relief.&quot;&quot;&quot;).toDF(&quot;text&quot;) val result = pipeline.fit(data).transform(data) Results |ner_chunk |mapping_result| |-------------------------|--------------| |ibuprofen topical cream |377732 | |selenium sulfide 25 mg/ml|328880 | |salicylamide 250 mg |316651 | Model Information Model Name: rxnorm_mapper Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [ner_chunk] Output Labels: [mappings] Language: en Size: 10.4 MB</summary></entry></feed>