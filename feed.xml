<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.2">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2026-01-19T09:16:11+00:00</updated><id>/feed.xml</id><title type="html">Spark NLP</title><subtitle>High Performance NLP with Apache Spark
</subtitle><author><name>{&quot;type&quot;=&gt;nil, &quot;name&quot;=&gt;nil, &quot;url&quot;=&gt;nil, &quot;avatar&quot;=&gt;nil, &quot;bio&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;facebook&quot;=&gt;nil, &quot;twitter&quot;=&gt;nil, &quot;weibo&quot;=&gt;nil, &quot;googleplus&quot;=&gt;nil, &quot;telegram&quot;=&gt;nil, &quot;medium&quot;=&gt;nil, &quot;zhihu&quot;=&gt;nil, &quot;douban&quot;=&gt;nil, &quot;linkedin&quot;=&gt;nil, &quot;github&quot;=&gt;nil, &quot;npm&quot;=&gt;nil}</name></author><entry><title type="html">Complete OMOP Pipeline for Entity Extraction and Assertion Status</title><link href="/2026/01/16/omop_ner_assertion_pipeline_en.html" rel="alternate" type="text/html" title="Complete OMOP Pipeline for Entity Extraction and Assertion Status" /><published>2026-01-16T00:00:00+00:00</published><updated>2026-01-16T00:00:00+00:00</updated><id>/2026/01/16/omop_ner_assertion_pipeline_en</id><content type="html" xml:base="/2026/01/16/omop_ner_assertion_pipeline_en.html">## Description

A comprehensive medical NLP pipeline designed for clinical entity extraction and assertion status detection from medical text.

**NER Models:**
- ner_jsl_langtest: Extracts 60+ medical entity types (symptoms, diseases, vitals, procedures, etc.)
- ner_posology_greedy: Extracts drug-related entities (DRUG, DOSAGE, FREQUENCY, ROUTE, etc.)
- ner_deid_subentity_augmented_v2: Extracts PATIENT, DOCTOR, and HOSPITAL names

**Text Matchers:**
- procedure_matcher, drug_matcher, cancer_diagnosis_matcher, symptom_matcher

**Contextual Parsers:**
- age_parser: Extracts age mentions
- date_matcher + DateNormalizer: Extracts and normalizes dates

**Assertion Models:**
- 9 Assertion models: family, someoneelse, absent, past, planned, conditional, hypothetical, possible

**Output:** Merged entities with assertion status (present, absent, past, family, planned, possible, conditional, hypothetical, someoneelse).
Additionally, in the output, you will see entities that are not related to the assertion status as `no_assertion`.

## Predicted Entities

`TEST`, `HOSPITAL`, `PATIENT`, `DOCTOR`, `ADMISSION_DISCHARGE`, `AGE`, `ALCOHOL`, `ALLERGEN`, `BIRTH_ENTITY`, `CEREBROVASCULAR_DISEASE`, `CLINICAL_DEPT`, `COMMUNICABLE_DISEASE`, `DEATH_ENTITY`, `DIABETES`, `DIET`, `DIRECTION`, `DISEASE_SYNDROME_DISORDER`, `EMPLOYMENT`, `EXTERNAL_BODY_PART_OR_REGION`, `FAMILY_HISTORY_HEADER`, `FETUS_NEWBORN`, `GENDER`, `HEART_DISEASE`, `HYPERLIPIDEMIA`, `HYPERTENSION`, `INJURY_OR_POISONING`, `INTERNAL_ORGAN_OR_COMPONENT`, `KIDNEY_DISEASE`, `LABOUR_DELIVERY`, `MEDICAL_DEVICE`, `MEDICAL_HISTORY_HEADER`, `MODIFIER`, `OBESITY`, `ONCOLOGICAL`, `OVERWEIGHT`, `OXYGEN_THERAPY`, `PREGNANCY`, `PROCEDURE`, `PSYCHOLOGICAL_CONDITION`, `RACE_ETHNICITY`, `RELATIONSHIP_STATUS`, `SECTION_HEADER`, `SEXUALLY_ACTIVE_OR_SEXUAL_ORIENTATION`, `SMOKING`, `SOCIAL_HISTORY_HEADER`, `SUBSTANCE`, `SUBSTANCE_QUANTITY`, `SYMPTOM`, `TREATMENT`, `VACCINE`, `VACCINE_NAME`, `VITAL_SIGNS_HEADER`, `TEST_RESULT`, `BLOOD_PRESSURE`, `PULSE`, `RESPIRATION`, `O2_SATURATION`, `TEMPERATURE`, `VS_FINDING`, `HEIGHT`, `WEIGHT`, `BMI`, `EKG_FINDINGS`, `IMAGINGFINDINGS`, `LDL`, `HDL`, `TRIGLYCERIDES`, `TOTAL_CHOLESTEROL`, `IMAGING_TECHNIQUE`, `DATE`, `RELATIVEDATE`, `RELATIVETIME`, `TIME`, `DRUG`, `STRENGTH`, `DURATION`, `FREQUENCY`, `FORM`, `DOSAGE`, `ROUTE`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/omop_ner_assertion_pipeline_en_6.2.0_3.4_1768594454879.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/omop_ner_assertion_pipeline_en_6.2.0_3.4_1768594454879.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

from sparknlp.pretrained import PretrainedPipeline

pipeline = PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately.
HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear.
NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas.
ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration.
EXTREMITIES: There is some edema, but no cyanosis and clubbing .
IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1.
  My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia.
  At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration.
  I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him.
  He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot;

result = pipeline.fullAnnotate(text)

```

{:.jsl-block}

```python

pipeline = nlp.PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately.
HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear.
NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas.
ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration.
EXTREMITIES: There is some edema, but no cyanosis and clubbing .
IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1.
  My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia.
  At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration.
  I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him.
  He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot;

result = pipeline.fullAnnotate(text)

```
```scala

import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline

val pipeline = PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;)

val text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately.
HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear.
NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas.
ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration.
EXTREMITIES: There is some edema, but no cyanosis and clubbing .
IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1.
  My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia.
  At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration.
  I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him.
  He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot;

val result = pipeline.fullAnnotate(text)

```
&lt;/div&gt;

## Results

```bash

+------------------------------------+-------+------+------------------------------+--------------+------+
|chunk_text                         |begin |end  |entity_type                  |assertion    |
+------------------------------------+-------+------+------------------------------+--------------+------+
|GENERAL:                           |0     |7    |VITAL_SIGNS_HEADER           |no_assertion |
|He                                 |9     |10   |GENDER                       |no_assertion |
|elderly                            |18    |24   |AGE                          |no_assertion |
|gentleman                          |26    |34   |GENDER                       |no_assertion |
|no acute distress                  |39    |55   |SYMPTOM                      |absent       |
|He                                 |58    |59   |GENDER                       |no_assertion |
|his                                |89    |91   |GENDER                       |no_assertion |
|He                                 |104   |105  |GENDER                       |no_assertion |
|Sclerae                            |175   |181  |INTERNAL_ORGAN_OR_COMPONENT  |no_assertion |
|mild                               |190   |193  |MODIFIER                     |no_assertion |
|arcus senilis                      |195   |207  |SYMPTOM                      |present      |
|right                              |216   |220  |DIRECTION                    |no_assertion |
|Left                               |223   |226  |DIRECTION                    |no_assertion |
|Pupils                             |239   |244  |EXTERNAL_BODY_PART_OR_REGION |no_assertion |
|Oropharynx                         |321   |330  |INTERNAL_ORGAN_OR_COMPONENT  |no_assertion |
|Trachea                            |356   |362  |INTERNAL_ORGAN_OR_COMPONENT  |no_assertion |
|midline                            |367   |373  |DIRECTION                    |no_assertion |
|jugular venous pressure distention |379   |412  |SYMPTOM                      |absent       |
|adenopathy                         |427   |436  |SYMPTOM                      |absent       |
|cervical                           |445   |452  |EXTERNAL_BODY_PART_OR_REGION |no_assertion |
|supraclavicular                    |455   |469  |EXTERNAL_BODY_PART_OR_REGION |no_assertion |
|axillary areas                     |475   |488  |EXTERNAL_BODY_PART_OR_REGION |no_assertion |
|tender                             |513   |518  |SYMPTOM                      |absent       |
|fullness                           |539   |546  |SYMPTOM                      |possible     |
|left                               |555   |558  |DIRECTION                    |no_assertion |
|upper quadrant                     |560   |573  |EXTERNAL_BODY_PART_OR_REGION |no_assertion |
|true spleen with inspiration       |607   |634  |SYMPTOM                      |absent       |
|edema                              |664   |668  |SYMPTOM                      |present      |
|cyanosis                           |678   |685  |SYMPTOM                      |absent       |
|clubbing                           |691   |698  |SYMPTOM                      |absent       |
|IMPRESSION:                        |702   |712  |SECTION_HEADER               |no_assertion |
|blood loss                         |746   |755  |SYMPTOM                      |absent       |
|esophagogastroduodenoscopy         |774   |799  |PROCEDURE                    |past         |
|negative                           |805   |812  |TEST_RESULT                  |past         |
|His                                |815   |817  |GENDER                       |no_assertion |
|creatinine                         |819   |828  |TEST                         |present      |
|he                                 |874   |875  |GENDER                       |no_assertion |
|underlying                         |893   |902  |MODIFIER                     |no_assertion |
|myelodysplastic syndrome           |904   |927  |Cancer_dx                    |possible     |
|bone marrow failure                |932   |950  |DISEASE_SYNDROME_DISORDER    |possible     |
|His                                |953   |955  |GENDER                       |no_assertion |
|creatinine                         |957   |966  |TEST                         |present      |
|hospitalization                    |976   |990  |ADMISSION_DISCHARGE          |no_assertion |
|1.6                                |1011  |1013 |TEST_RESULT                  |present      |
|his                                |1042  |1044 |GENDER                       |no_assertion |
|anemia                             |1046  |1051 |DISEASE_SYNDROME_DISORDER    |possible     |
|he                                 |1112  |1113 |GENDER                       |no_assertion |
|bone marrow aspiration             |1132  |1153 |PROCEDURE                    |hypothetical |
|procedure                          |1179  |1187 |PROCEDURE                    |planned      |
|bone marrow                        |1310  |1320 |INTERNAL_ORGAN_OR_COMPONENT  |no_assertion |
|his                                |1337  |1339 |GENDER                       |no_assertion |
|refractory                         |1350  |1359 |MODIFIER                     |no_assertion |
|anemia                             |1361  |1366 |DISEASE_SYNDROME_DISORDER    |present      |
|him                                |1436  |1438 |GENDER                       |no_assertion |
|He                                 |1443  |1444 |GENDER                       |no_assertion |
|him                                |1505  |1507 |GENDER                       |no_assertion |
|ultrasound                         |1527  |1536 |PROCEDURE                    |planned      |
|fullness                           |1577  |1584 |SYMPTOM                      |possible     |
+------------------------------------+-------+------+------------------------------+--------------+------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|omop_ner_assertion_pipeline|
|Type:|pipeline|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|1.8 GB|

## Included Models

- DocumentAssembler
- SentenceDetector
- TokenizerModel
- WordEmbeddingsModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- RegexMatcherInternalModel
- NerConverterInternalModel
- ChunkMergeModel
- DateNormalizer
- ContextualParserModel
- ChunkConverter
- ChunkMergeModel
- ChunkMergeModel
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- ContextualAssertion
- AssertionDLModel
- AssertionMerger
- AssertionFilterer
- ChunkMergeModel</content><author><name>John Snow Labs</name></author><category term="licensed" /><category term="en" /><category term="clinical" /><category term="pipeline" /><category term="ner" /><category term="assertion" /><category term="omop" /><summary type="html">Description A comprehensive medical NLP pipeline designed for clinical entity extraction and assertion status detection from medical text. NER Models: ner_jsl_langtest: Extracts 60+ medical entity types (symptoms, diseases, vitals, procedures, etc.) ner_posology_greedy: Extracts drug-related entities (DRUG, DOSAGE, FREQUENCY, ROUTE, etc.) ner_deid_subentity_augmented_v2: Extracts PATIENT, DOCTOR, and HOSPITAL names Text Matchers: procedure_matcher, drug_matcher, cancer_diagnosis_matcher, symptom_matcher Contextual Parsers: age_parser: Extracts age mentions date_matcher + DateNormalizer: Extracts and normalizes dates Assertion Models: 9 Assertion models: family, someoneelse, absent, past, planned, conditional, hypothetical, possible Output: Merged entities with assertion status (present, absent, past, family, planned, possible, conditional, hypothetical, someoneelse). Additionally, in the output, you will see entities that are not related to the assertion status as no_assertion. Predicted Entities TEST, HOSPITAL, PATIENT, DOCTOR, ADMISSION_DISCHARGE, AGE, ALCOHOL, ALLERGEN, BIRTH_ENTITY, CEREBROVASCULAR_DISEASE, CLINICAL_DEPT, COMMUNICABLE_DISEASE, DEATH_ENTITY, DIABETES, DIET, DIRECTION, DISEASE_SYNDROME_DISORDER, EMPLOYMENT, EXTERNAL_BODY_PART_OR_REGION, FAMILY_HISTORY_HEADER, FETUS_NEWBORN, GENDER, HEART_DISEASE, HYPERLIPIDEMIA, HYPERTENSION, INJURY_OR_POISONING, INTERNAL_ORGAN_OR_COMPONENT, KIDNEY_DISEASE, LABOUR_DELIVERY, MEDICAL_DEVICE, MEDICAL_HISTORY_HEADER, MODIFIER, OBESITY, ONCOLOGICAL, OVERWEIGHT, OXYGEN_THERAPY, PREGNANCY, PROCEDURE, PSYCHOLOGICAL_CONDITION, RACE_ETHNICITY, RELATIONSHIP_STATUS, SECTION_HEADER, SEXUALLY_ACTIVE_OR_SEXUAL_ORIENTATION, SMOKING, SOCIAL_HISTORY_HEADER, SUBSTANCE, SUBSTANCE_QUANTITY, SYMPTOM, TREATMENT, VACCINE, VACCINE_NAME, VITAL_SIGNS_HEADER, TEST_RESULT, BLOOD_PRESSURE, PULSE, RESPIRATION, O2_SATURATION, TEMPERATURE, VS_FINDING, HEIGHT, WEIGHT, BMI, EKG_FINDINGS, IMAGINGFINDINGS, LDL, HDL, TRIGLYCERIDES, TOTAL_CHOLESTEROL, IMAGING_TECHNIQUE, DATE, RELATIVEDATE, RELATIVETIME, TIME, DRUG, STRENGTH, DURATION, FREQUENCY, FORM, DOSAGE, ROUTE Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU from sparknlp.pretrained import PretrainedPipeline pipeline = PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately. HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear. NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas. ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration. EXTREMITIES: There is some edema, but no cyanosis and clubbing . IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1. My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia. At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration. I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him. He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot; result = pipeline.fullAnnotate(text) pipeline = nlp.PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;) text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately. HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear. NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas. ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration. EXTREMITIES: There is some edema, but no cyanosis and clubbing . IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1. My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia. At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration. I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him. He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot; result = pipeline.fullAnnotate(text) import com.johnsnowlabs.nlp.pretrained.PretrainedPipeline val pipeline = PretrainedPipeline(&quot;omop_ner_assertion_pipeline&quot;, &quot;en&quot;, &quot;clinical/models&quot;) val text = &quot;&quot;&quot;GENERAL: He is an elderly gentleman in no acute distress. He is sitting up in bed eating his breakfast. He is alert and oriented and answering questions appropriately. HEENT: Sclerae showed mild arcus senilis in the right. Left was clear. Pupils are equally round and reactive to light. Extraocular movements are intact. Oropharynx is clear. NECK: Supple. Trachea is midline. No jugular venous pressure distention is noted. No adenopathy in the cervical, supraclavicular, or axillary areas. ABDOMEN: Soft and not tender. There may be some fullness in the left upper quadrant, although I do not appreciate a true spleen with inspiration. EXTREMITIES: There is some edema, but no cyanosis and clubbing . IMPRESSION: There are no sign or symptom of blood loss and the previous esophagogastroduodenoscopy was negative. His creatinine was 1. My impression at this time is that he probably has an underlying myelodysplastic syndrome or bone marrow failure. His creatinine on this hospitalization was up slightly to 1.6 and this may contribute to his anemia. At this time, my recommendation for the patient is that he should undergo a bone marrow aspiration. I have discussed the procedure in detail which the patient. I have discussed the risks, benefits, and successes of that treatment and usefulness of the bone marrow and predicting his cause of refractory anemia and further therapeutic interventions, which might be beneficial to him. He is willing to proceed with the studies I have described to him. We will order an ultrasound of his abdomen because of the possible fullness of the spleen.&quot;&quot;&quot; val result = pipeline.fullAnnotate(text) Results +------------------------------------+-------+------+------------------------------+--------------+------+ |chunk_text |begin |end |entity_type |assertion | +------------------------------------+-------+------+------------------------------+--------------+------+ |GENERAL: |0 |7 |VITAL_SIGNS_HEADER |no_assertion | |He |9 |10 |GENDER |no_assertion | |elderly |18 |24 |AGE |no_assertion | |gentleman |26 |34 |GENDER |no_assertion | |no acute distress |39 |55 |SYMPTOM |absent | |He |58 |59 |GENDER |no_assertion | |his |89 |91 |GENDER |no_assertion | |He |104 |105 |GENDER |no_assertion | |Sclerae |175 |181 |INTERNAL_ORGAN_OR_COMPONENT |no_assertion | |mild |190 |193 |MODIFIER |no_assertion | |arcus senilis |195 |207 |SYMPTOM |present | |right |216 |220 |DIRECTION |no_assertion | |Left |223 |226 |DIRECTION |no_assertion | |Pupils |239 |244 |EXTERNAL_BODY_PART_OR_REGION |no_assertion | |Oropharynx |321 |330 |INTERNAL_ORGAN_OR_COMPONENT |no_assertion | |Trachea |356 |362 |INTERNAL_ORGAN_OR_COMPONENT |no_assertion | |midline |367 |373 |DIRECTION |no_assertion | |jugular venous pressure distention |379 |412 |SYMPTOM |absent | |adenopathy |427 |436 |SYMPTOM |absent | |cervical |445 |452 |EXTERNAL_BODY_PART_OR_REGION |no_assertion | |supraclavicular |455 |469 |EXTERNAL_BODY_PART_OR_REGION |no_assertion | |axillary areas |475 |488 |EXTERNAL_BODY_PART_OR_REGION |no_assertion | |tender |513 |518 |SYMPTOM |absent | |fullness |539 |546 |SYMPTOM |possible | |left |555 |558 |DIRECTION |no_assertion | |upper quadrant |560 |573 |EXTERNAL_BODY_PART_OR_REGION |no_assertion | |true spleen with inspiration |607 |634 |SYMPTOM |absent | |edema |664 |668 |SYMPTOM |present | |cyanosis |678 |685 |SYMPTOM |absent | |clubbing |691 |698 |SYMPTOM |absent | |IMPRESSION: |702 |712 |SECTION_HEADER |no_assertion | |blood loss |746 |755 |SYMPTOM |absent | |esophagogastroduodenoscopy |774 |799 |PROCEDURE |past | |negative |805 |812 |TEST_RESULT |past | |His |815 |817 |GENDER |no_assertion | |creatinine |819 |828 |TEST |present | |he |874 |875 |GENDER |no_assertion | |underlying |893 |902 |MODIFIER |no_assertion | |myelodysplastic syndrome |904 |927 |Cancer_dx |possible | |bone marrow failure |932 |950 |DISEASE_SYNDROME_DISORDER |possible | |His |953 |955 |GENDER |no_assertion | |creatinine |957 |966 |TEST |present | |hospitalization |976 |990 |ADMISSION_DISCHARGE |no_assertion | |1.6 |1011 |1013 |TEST_RESULT |present | |his |1042 |1044 |GENDER |no_assertion | |anemia |1046 |1051 |DISEASE_SYNDROME_DISORDER |possible | |he |1112 |1113 |GENDER |no_assertion | |bone marrow aspiration |1132 |1153 |PROCEDURE |hypothetical | |procedure |1179 |1187 |PROCEDURE |planned | |bone marrow |1310 |1320 |INTERNAL_ORGAN_OR_COMPONENT |no_assertion | |his |1337 |1339 |GENDER |no_assertion | |refractory |1350 |1359 |MODIFIER |no_assertion | |anemia |1361 |1366 |DISEASE_SYNDROME_DISORDER |present | |him |1436 |1438 |GENDER |no_assertion | |He |1443 |1444 |GENDER |no_assertion | |him |1505 |1507 |GENDER |no_assertion | |ultrasound |1527 |1536 |PROCEDURE |planned | |fullness |1577 |1584 |SYMPTOM |possible | +------------------------------------+-------+------+------------------------------+--------------+------+ Model Information Model Name: omop_ner_assertion_pipeline Type: pipeline Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Language: en Size: 1.8 GB Included Models DocumentAssembler SentenceDetector TokenizerModel WordEmbeddingsModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel TextMatcherInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel RegexMatcherInternalModel NerConverterInternalModel ChunkMergeModel DateNormalizer ContextualParserModel ChunkConverter ChunkMergeModel ChunkMergeModel ContextualAssertion ContextualAssertion ContextualAssertion ContextualAssertion ContextualAssertion ContextualAssertion ContextualAssertion ContextualAssertion AssertionDLModel AssertionMerger AssertionFilterer ChunkMergeModel</summary></entry><entry><title type="html">explain_oncology_scala2.13_test</title><link href="/2026/01/14/explain_oncology_scala2.13_test_en.html" rel="alternate" type="text/html" title="explain_oncology_scala2.13_test" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/explain_oncology_scala2.13_test_en</id><content type="html" xml:base="/2026/01/14/explain_oncology_scala2.13_test_en.html">## Description

TEST

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/explain_oncology_scala2.13_test_en_6.3.2_3.4_1768383434268.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/explain_oncology_scala2.13_test_en_6.3.2_3.4_1768383434268.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
```python
# TEST
```

&lt;/div&gt;

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|explain_oncology_scala2.13_test|
|Type:|pipeline|
|Compatibility:|Spark NLP 6.3.2+|
|License:|Licensed|
|Edition:|Official|
|Language:|en|
|Size:|2.0 GB|

## Included Models

- DocumentAssembler
- SentenceDetectorDLModel
- TokenizerModel
- WordEmbeddingsModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- MedicalNerModel
- NerConverterInternalModel
- TextMatcherInternalModel
- TextMatcherInternalModel
- ChunkMergeModel
- ChunkMergeModel
- AssertionDLModel
- PerceptronModel
- DependencyParserModel
- RelationExtractionModel
- PosologyREModel
- AnnotationMerger</content><author><name>John Snow Labs</name></author><category term="test" /><category term="en" /><category term="licensed" /><summary type="html">Description TEST Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU # TEST Model Information Model Name: explain_oncology_scala2.13_test Type: pipeline Compatibility: Spark NLP 6.3.2+ License: Licensed Edition: Official Language: en Size: 2.0 GB Included Models DocumentAssembler SentenceDetectorDLModel TokenizerModel WordEmbeddingsModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel MedicalNerModel NerConverterInternalModel TextMatcherInternalModel TextMatcherInternalModel ChunkMergeModel ChunkMergeModel AssertionDLModel PerceptronModel DependencyParserModel RelationExtractionModel PosologyREModel AnnotationMerger</summary></entry><entry><title type="html">Detect Absent Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_absent_en.html" rel="alternate" type="text/html" title="Detect Absent Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_absent_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_absent_en.html">## Description

Identifies medical conditions that are explicitly absent or denied in the patient.

## Predicted Entities

`absent`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_absent_en_6.2.0_3.4_1768420413936.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_absent_en_6.2.0_3.4_1768420413936.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_absent&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_absent&quot;)\
    .setExplodeSelectedFields({&quot;assertion_absent&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_absent&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_absent&quot;)\
    .setExplodeSelectedFields({&quot;assertion_absent&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_absent&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_absent&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_absent&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+---------------------+-------+-----+-----------+-----------+
|ner_chunk            |begin  |end  |ner_label  |result     |
+---------------------+-------+-----+-----------+-----------+
|any chest pain       |19     |32   |PROBLEM    |absent     |
|shortness of breath  |35     |53   |PROBLEM    |absent     |
|fever                |59     |63   |PROBLEM    |absent     |
|diabetes             |80     |87   |PROBLEM    |absent     |
|hypertension         |92     |103  |PROBLEM    |absent     |
+---------------------+-------+-----+-----------+-----------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_absent|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_absent]|
|Language:|en|
|Size:|2.0 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="absent" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that are explicitly absent or denied in the patient. Predicted Entities absent Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_absent&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_absent&quot;)\ .setExplodeSelectedFields({&quot;assertion_absent&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_absent&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_absent&quot;)\ .setExplodeSelectedFields({&quot;assertion_absent&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_absent&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_absent&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_absent&quot;) .setExplodeSelectedFields(Map(&quot;assertion_absent&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;The patient denies any chest pain, shortness of breath, or fever. No history of diabetes or hypertension.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +---------------------+-------+-----+-----------+-----------+ |ner_chunk |begin |end |ner_label |result | +---------------------+-------+-----+-----------+-----------+ |any chest pain |19 |32 |PROBLEM |absent | |shortness of breath |35 |53 |PROBLEM |absent | |fever |59 |63 |PROBLEM |absent | |diabetes |80 |87 |PROBLEM |absent | |hypertension |92 |103 |PROBLEM |absent | +---------------------+-------+-----+-----------+-----------+ Model Information Model Name: contextual_assertion_absent Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_absent] Language: en Size: 2.0 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Conditional Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_conditional_en.html" rel="alternate" type="text/html" title="Detect Conditional Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_conditional_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_conditional_en.html">## Description

Identifies medical conditions that are conditional or dependent on certain circumstances.

## Predicted Entities

`conditional`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_conditional_en_6.2.0_3.4_1768420425437.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_conditional_en_6.2.0_3.4_1768420425437.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_conditional&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_conditional&quot;)\
    .setExplodeSelectedFields({&quot;assertion_conditional&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_conditional&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_conditional&quot;)\
    .setExplodeSelectedFields({&quot;assertion_conditional&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_conditional&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_conditional&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_conditional&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+------------+-------+-----+-----------+-------------+
|ner_chunk   |begin  |end  |ner_label  |result       |
+------------+-------+-----+-----------+-------------+
|chest pain  |20     |29   |PROBLEM    |conditional  |
|Dyspnea     |44     |50   |PROBLEM    |conditional  |
|Headaches   |82     |90   |PROBLEM    |conditional  |
|stress      |105    |110  |PROBLEM    |conditional  |
+------------+-------+-----+-----------+-------------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_conditional|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_conditional]|
|Language:|en|
|Size:|1.8 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="conditional" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that are conditional or dependent on certain circumstances. Predicted Entities conditional Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_conditional&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_conditional&quot;)\ .setExplodeSelectedFields({&quot;assertion_conditional&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_conditional&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_conditional&quot;)\ .setExplodeSelectedFields({&quot;assertion_conditional&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_conditional&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_conditional&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_conditional&quot;) .setExplodeSelectedFields(Map(&quot;assertion_conditional&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Patient experiences chest pain on exertion. Dyspnea worse with physical activity. Headaches triggered by stress.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +------------+-------+-----+-----------+-------------+ |ner_chunk |begin |end |ner_label |result | +------------+-------+-----+-----------+-------------+ |chest pain |20 |29 |PROBLEM |conditional | |Dyspnea |44 |50 |PROBLEM |conditional | |Headaches |82 |90 |PROBLEM |conditional | |stress |105 |110 |PROBLEM |conditional | +------------+-------+-----+-----------+-------------+ Model Information Model Name: contextual_assertion_conditional Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_conditional] Language: en Size: 1.8 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Family Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_family_en.html" rel="alternate" type="text/html" title="Detect Family Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_family_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_family_en.html">## Description

Identifies medical conditions that belong to family members rather than the patient.

## Predicted Entities

`family`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_family_en_6.2.0_3.4_1768420436871.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_family_en_6.2.0_3.4_1768420436871.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_family&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_family&quot;)\
    .setExplodeSelectedFields({&quot;assertion_family&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_family&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_family&quot;)\
    .setExplodeSelectedFields({&quot;assertion_family&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_family&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_family&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_family&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+---------------+-------+-----+-----------+-----------+
|ner_chunk      |begin  |end  |ner_label  |result     |
+---------------+-------+-----+-----------+-----------+
|diabetes       |11     |18   |PROBLEM    |family     |
|breast cancer  |35     |47   |PROBLEM    |family     |
|migraines      |70     |78   |PROBLEM    |family     |
+---------------+-------+-----+-----------+-----------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_family|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_family]|
|Language:|en|
|Size:|2.3 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="family" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that belong to family members rather than the patient. Predicted Entities family Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_family&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_family&quot;)\ .setExplodeSelectedFields({&quot;assertion_family&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_family&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_family&quot;)\ .setExplodeSelectedFields({&quot;assertion_family&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_family&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_family&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_family&quot;) .setExplodeSelectedFields(Map(&quot;assertion_family&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Father has diabetes and mother had breast cancer. Sister suffers from migraines.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +---------------+-------+-----+-----------+-----------+ |ner_chunk |begin |end |ner_label |result | +---------------+-------+-----+-----------+-----------+ |diabetes |11 |18 |PROBLEM |family | |breast cancer |35 |47 |PROBLEM |family | |migraines |70 |78 |PROBLEM |family | +---------------+-------+-----+-----------+-----------+ Model Information Model Name: contextual_assertion_family Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_family] Language: en Size: 2.3 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Hypothetical Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_hypothetical_en.html" rel="alternate" type="text/html" title="Detect Hypothetical Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_hypothetical_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_hypothetical_en.html">## Description

Identifies medical conditions mentioned in hypothetical or uncertain contexts.

## Predicted Entities

`hypothetical`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_hypothetical_en_6.2.0_3.4_1768420448298.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_hypothetical_en_6.2.0_3.4_1768420448298.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_hypothetical&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_hypothetical&quot;)\
    .setExplodeSelectedFields({&quot;assertion_hypothetical&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_hypothetical&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_hypothetical&quot;)\
    .setExplodeSelectedFields({&quot;assertion_hypothetical&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_hypothetical&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_hypothetical&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_hypothetical&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+--------------------+-------+-----+-----------+--------------+
|ner_chunk           |begin  |end  |ner_label  |result        |
+--------------------+-------+-----+-----------+--------------+
|infection           |34     |42   |PROBLEM    |hypothetical  |
|monitoring          |61     |70   |TEST       |hypothetical  |
|allergic reactions  |86     |103  |PROBLEM    |hypothetical  |
+--------------------+-------+-----+-----------+--------------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_hypothetical|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_hypothetical]|
|Language:|en|
|Size:|1.8 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="hypothetical" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions mentioned in hypothetical or uncertain contexts. Predicted Entities hypothetical Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_hypothetical&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_hypothetical&quot;)\ .setExplodeSelectedFields({&quot;assertion_hypothetical&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_hypothetical&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_hypothetical&quot;)\ .setExplodeSelectedFields({&quot;assertion_hypothetical&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_hypothetical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_hypothetical&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_hypothetical&quot;) .setExplodeSelectedFields(Map(&quot;assertion_hypothetical&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Patient should watch for signs of infection. Would recommend monitoring for potential allergic reactions.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +--------------------+-------+-----+-----------+--------------+ |ner_chunk |begin |end |ner_label |result | +--------------------+-------+-----+-----------+--------------+ |infection |34 |42 |PROBLEM |hypothetical | |monitoring |61 |70 |TEST |hypothetical | |allergic reactions |86 |103 |PROBLEM |hypothetical | +--------------------+-------+-----+-----------+--------------+ Model Information Model Name: contextual_assertion_hypothetical Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_hypothetical] Language: en Size: 1.8 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Past Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_past_en.html" rel="alternate" type="text/html" title="Detect Past Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_past_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_past_en.html">## Description

Identifies medical conditions that occurred in the patient's past medical history.

## Predicted Entities

`past`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_past_en_6.2.0_3.4_1768420459785.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_past_en_6.2.0_3.4_1768420459785.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_past&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_past&quot;)\
    .setExplodeSelectedFields({&quot;assertion_past&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_past&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_past&quot;)\
    .setExplodeSelectedFields({&quot;assertion_past&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_past&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_past&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_past&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+--------------+-------+-----+-----------+-----------+
|ner_chunk     |begin  |end  |ner_label  |result     |
+--------------+-------+-----+-----------+-----------+
|pneumonia     |12     |20   |PROBLEM    |past       |
|appendectomy  |63     |74   |TREATMENT  |past       |
+--------------+-------+-----+-----------+-----------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_past|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_past]|
|Language:|en|
|Size:|2.3 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="past" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that occurred in the patients past medical history. Predicted Entities past Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_past&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_past&quot;)\ .setExplodeSelectedFields({&quot;assertion_past&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_past&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_past&quot;)\ .setExplodeSelectedFields({&quot;assertion_past&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_past&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_past&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_past&quot;) .setExplodeSelectedFields(Map(&quot;assertion_past&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Patient had pneumonia last year and recovered well. History of appendectomy in 2015.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +--------------+-------+-----+-----------+-----------+ |ner_chunk |begin |end |ner_label |result | +--------------+-------+-----+-----------+-----------+ |pneumonia |12 |20 |PROBLEM |past | |appendectomy |63 |74 |TREATMENT |past | +--------------+-------+-----+-----------+-----------+ Model Information Model Name: contextual_assertion_past Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_past] Language: en Size: 2.3 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Planned Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_planned_en.html" rel="alternate" type="text/html" title="Detect Planned Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_planned_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_planned_en.html">## Description

Identifies medical procedures or treatments that are planned for the future.

## Predicted Entities

`planned`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_planned_en_6.2.0_3.4_1768420471310.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_planned_en_6.2.0_3.4_1768420471310.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_planned&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_planned&quot;)\
    .setExplodeSelectedFields({&quot;assertion_planned&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_planned&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_planned&quot;)\
    .setExplodeSelectedFields({&quot;assertion_planned&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_planned&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_planned&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_planned&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+--------------------------+-------+-----+-----------+-----------+
|ner_chunk                 |begin  |end  |ner_label  |result     |
+--------------------------+-------+-----+-----------+-----------+
|knee replacement surgery  |22     |45   |TREATMENT  |planned    |
|physical therapy          |70     |85   |TREATMENT  |planned    |
|procedure                 |93     |101  |TREATMENT  |planned    |
+--------------------------+-------+-----+-----------+-----------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_planned|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_planned]|
|Language:|en|
|Size:|1.9 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="planned" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical procedures or treatments that are planned for the future. Predicted Entities planned Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_planned&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_planned&quot;)\ .setExplodeSelectedFields({&quot;assertion_planned&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_planned&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_planned&quot;)\ .setExplodeSelectedFields({&quot;assertion_planned&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_planned&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_planned&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_planned&quot;) .setExplodeSelectedFields(Map(&quot;assertion_planned&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Patient scheduled for knee replacement surgery next month. Will start physical therapy after procedure.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +--------------------------+-------+-----+-----------+-----------+ |ner_chunk |begin |end |ner_label |result | +--------------------------+-------+-----+-----------+-----------+ |knee replacement surgery |22 |45 |TREATMENT |planned | |physical therapy |70 |85 |TREATMENT |planned | |procedure |93 |101 |TREATMENT |planned | +--------------------------+-------+-----+-----------+-----------+ Model Information Model Name: contextual_assertion_planned Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_planned] Language: en Size: 1.9 KB Case sensitive: false</summary></entry><entry><title type="html">Detect Possible Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_possible_en.html" rel="alternate" type="text/html" title="Detect Possible Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_possible_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_possible_en.html">## Description

Identifies medical conditions that are possible or suspected but not confirmed.

## Predicted Entities

`possible`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_possible_en_6.2.0_3.4_1768420482875.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_possible_en_6.2.0_3.4_1768420482875.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_possible&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_possible&quot;)\
    .setExplodeSelectedFields({&quot;assertion_possible&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_possible&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_possible&quot;)\
    .setExplodeSelectedFields({&quot;assertion_possible&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_possible&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_possible&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_possible&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+-------------------------+-------+-----+-----------+-----------+
|ner_chunk                |begin  |end  |ner_label  |result     |
+-------------------------+-------+-----+-----------+-----------+
|pneumonia                |9      |17   |PROBLEM    |possible   |
|chest X-ray              |28     |38   |TEST       |possible   |
|early arthritis          |58     |72   |PROBLEM    |possible   |
|urinary tract infection  |85     |107  |PROBLEM    |possible   |
+-------------------------+-------+-----+-----------+-----------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_possible|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_possible]|
|Language:|en|
|Size:|2.2 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="possible" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that are possible or suspected but not confirmed. Predicted Entities possible Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_possible&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_possible&quot;)\ .setExplodeSelectedFields({&quot;assertion_possible&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_possible&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_possible&quot;)\ .setExplodeSelectedFields({&quot;assertion_possible&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_possible&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_possible&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_possible&quot;) .setExplodeSelectedFields(Map(&quot;assertion_possible&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Possible pneumonia based on chest X-ray. Patient may have early arthritis. Suspected urinary tract infection.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +-------------------------+-------+-----+-----------+-----------+ |ner_chunk |begin |end |ner_label |result | +-------------------------+-------+-----+-----------+-----------+ |pneumonia |9 |17 |PROBLEM |possible | |chest X-ray |28 |38 |TEST |possible | |early arthritis |58 |72 |PROBLEM |possible | |urinary tract infection |85 |107 |PROBLEM |possible | +-------------------------+-------+-----+-----------+-----------+ Model Information Model Name: contextual_assertion_possible Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_possible] Language: en Size: 2.2 KB Case sensitive: false</summary></entry><entry><title type="html">Detect SomeoneElse Assertion Status with Contextual Assertion</title><link href="/2026/01/14/contextual_assertion_someoneelse_en.html" rel="alternate" type="text/html" title="Detect SomeoneElse Assertion Status with Contextual Assertion" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T00:00:00+00:00</updated><id>/2026/01/14/contextual_assertion_someoneelse_en</id><content type="html" xml:base="/2026/01/14/contextual_assertion_someoneelse_en.html">## Description

Identifies medical conditions that belong to someone other than the patient (not family).

## Predicted Entities

`someoneelse`

{:.btn-box}
&lt;button class=&quot;button button-orange&quot; disabled&gt;Live Demo&lt;/button&gt;
&lt;button class=&quot;button button-orange&quot; disabled&gt;Open in Colab&lt;/button&gt;
[Download](https://s3.amazonaws.com/auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_someoneelse_en_6.2.0_3.4_1768420494346.zip){:.button.button-orange.button-orange-trans.arr.button-icon.hidden}
[Copy S3 URI](s3://auxdata.johnsnowlabs.com/clinical/models/contextual_assertion_someoneelse_en_6.2.0_3.4_1768420494346.zip){:.button.button-orange.button-orange-trans.button-icon.button-copy-s3}

## How to use



&lt;div class=&quot;tabs-box&quot; markdown=&quot;1&quot;&gt;
{% include programmingLanguageSelectScalaPythonNLU.html %}
  
```python

document_assembler = DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = ContextualAssertion\
    .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_someoneelse&quot;)

flattener = Flattener()\
    .setInputCols(&quot;assertion_someoneelse&quot;)\
    .setExplodeSelectedFields({&quot;assertion_someoneelse&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```

{:.jsl-block}
```python

document_assembler = nlp.DocumentAssembler()\
    .setInputCol(&quot;text&quot;)\
    .setOutputCol(&quot;document&quot;)

sentence_detector = nlp.SentenceDetector()\
    .setInputCols([&quot;document&quot;])\
    .setOutputCol(&quot;sentence&quot;)

tokenizer = nlp.Tokenizer()\
    .setInputCols([&quot;sentence&quot;])\
    .setOutputCol(&quot;token&quot;)

word_embeddings = nlp.WordEmbeddingsModel\
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\
    .setOutputCol(&quot;embeddings&quot;)

clinical_ner = medical.MedicalNerModel\
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\
    .setOutputCol(&quot;ner&quot;)

ner_converter = medical.NerConverterInternal()\
    .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\
    .setOutputCol(&quot;ner_chunk&quot;)

contextual_assertion = medical.ContextualAssertion\
    .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\
    .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\
    .setOutputCol(&quot;assertion_someoneelse&quot;)

flattener = medical.Flattener()\
    .setInputCols(&quot;assertion_someoneelse&quot;)\
    .setExplodeSelectedFields({&quot;assertion_someoneelse&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;,
                                                      &quot;begin as begin&quot;,
                                                      &quot;end as end&quot;,
                                                      &quot;metadata.ner_label as ner_label&quot;,
                                                      &quot;result&quot;]})

pipeline = nlp.Pipeline(stages=[
    document_assembler,
    sentence_detector,
    tokenizer,
    word_embeddings,
    clinical_ner,
    ner_converter,
    contextual_assertion,
    flattener
])

empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;)
model = pipeline.fit(empty_data)

text = &quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot;
data = spark.createDataFrame([[text]]).toDF('text')
result = model.transform(data)

```
```scala

val documentAssembler = new DocumentAssembler()
    .setInputCol(&quot;text&quot;)
    .setOutputCol(&quot;document&quot;)

val sentenceDetector = new SentenceDetector()
    .setInputCols(Array(&quot;document&quot;))
    .setOutputCol(&quot;sentences&quot;)

val tokenizer = new Tokenizer()
    .setInputCols(Array(&quot;sentences&quot;))
    .setOutputCol(&quot;tokens&quot;)

val embedder = WordEmbeddingsModel
    .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;))
    .setOutputCol(&quot;embeddings&quot;)

val nerTagger = MedicalNerModel
    .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;))
    .setOutputCol(&quot;nerTags&quot;)

val nerConverter = new NerConverterInternal()
    .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;))
    .setOutputCol(&quot;nerChunks&quot;)

val contextualAssertion = ContextualAssertion
    .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;)
    .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;)
    .setOutputCol(&quot;assertion_someoneelse&quot;)

val flattener = new Flattener()
    .setInputCols(&quot;assertion_someoneelse&quot;)
    .setExplodeSelectedFields(Map(&quot;assertion_someoneelse&quot; -&gt; Array(
        &quot;metadata.ner_chunk as ner_chunk&quot;,
        &quot;begin as begin&quot;,
        &quot;end as end&quot;,
        &quot;metadata.ner_label as ner_label&quot;,
        &quot;result as result&quot;
    )))

val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;)

val pipeline = new Pipeline()
    .setStages(Array(
        documentAssembler,
        sentenceDetector,
        tokenizer,
        embedder,
        nerTagger,
        nerConverter,
        contextualAssertion,
        flattener
    )).fit(emptyDataSet)

val text = Seq(&quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;)
val dataSetResult = pipeline.transform(text)

```
&lt;/div&gt;

## Results

```bash

+--------------+-------+-----+-----------+-------------+
|ner_chunk     |begin  |end  |ner_label  |result       |
+--------------+-------+-----+-----------+-------------+
|hypertension  |30     |41   |PROBLEM    |someoneelse  |
|influenza     |80     |88   |PROBLEM    |someoneelse  |
+--------------+-------+-----+-----------+-------------+

```

{:.model-param}
## Model Information

{:.table-model}
|---|---|
|Model Name:|contextual_assertion_someoneelse|
|Compatibility:|Healthcare NLP 6.2.0+|
|License:|Licensed|
|Edition:|Official|
|Input Labels:|[sentence, token, ner_chunk]|
|Output Labels:|[custom_someoneelse]|
|Language:|en|
|Size:|1.8 KB|
|Case sensitive:|false|</content><author><name>John Snow Labs</name></author><category term="someoneelse" /><category term="en" /><category term="assertion" /><category term="contextual_assertion" /><category term="licensed" /><category term="clinical" /><summary type="html">Description Identifies medical conditions that belong to someone other than the patient (not family). Predicted Entities someoneelse Live Demo Open in Colab Download Copy S3 URI How to use PythonHealthcare NLPPythonJohnSnowLabsScalaNLU document_assembler = DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = ContextualAssertion\ .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_someoneelse&quot;) flattener = Flattener()\ .setInputCols(&quot;assertion_someoneelse&quot;)\ .setExplodeSelectedFields({&quot;assertion_someoneelse&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) document_assembler = nlp.DocumentAssembler()\ .setInputCol(&quot;text&quot;)\ .setOutputCol(&quot;document&quot;) sentence_detector = nlp.SentenceDetector()\ .setInputCols([&quot;document&quot;])\ .setOutputCol(&quot;sentence&quot;) tokenizer = nlp.Tokenizer()\ .setInputCols([&quot;sentence&quot;])\ .setOutputCol(&quot;token&quot;) word_embeddings = nlp.WordEmbeddingsModel\ .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;])\ .setOutputCol(&quot;embeddings&quot;) clinical_ner = medical.MedicalNerModel\ .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;embeddings&quot;])\ .setOutputCol(&quot;ner&quot;) ner_converter = medical.NerConverterInternal()\ .setInputCols([&quot;sentence&quot;, &quot;token&quot;, &quot;ner&quot;])\ .setOutputCol(&quot;ner_chunk&quot;) contextual_assertion = medical.ContextualAssertion\ .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;)\ .setInputCols(&quot;sentence&quot;, &quot;token&quot;, &quot;ner_chunk&quot;)\ .setOutputCol(&quot;assertion_someoneelse&quot;) flattener = medical.Flattener()\ .setInputCols(&quot;assertion_someoneelse&quot;)\ .setExplodeSelectedFields({&quot;assertion_someoneelse&quot;: [&quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result&quot;]}) pipeline = nlp.Pipeline(stages=[ document_assembler, sentence_detector, tokenizer, word_embeddings, clinical_ner, ner_converter, contextual_assertion, flattener ]) empty_data = spark.createDataFrame([[&quot;&quot;]]).toDF(&quot;text&quot;) model = pipeline.fit(empty_data) text = &quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot; data = spark.createDataFrame([[text]]).toDF('text') result = model.transform(data) val documentAssembler = new DocumentAssembler() .setInputCol(&quot;text&quot;) .setOutputCol(&quot;document&quot;) val sentenceDetector = new SentenceDetector() .setInputCols(Array(&quot;document&quot;)) .setOutputCol(&quot;sentences&quot;) val tokenizer = new Tokenizer() .setInputCols(Array(&quot;sentences&quot;)) .setOutputCol(&quot;tokens&quot;) val embedder = WordEmbeddingsModel .pretrained(&quot;embeddings_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;)) .setOutputCol(&quot;embeddings&quot;) val nerTagger = MedicalNerModel .pretrained(&quot;ner_clinical&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;embeddings&quot;)) .setOutputCol(&quot;nerTags&quot;) val nerConverter = new NerConverterInternal() .setInputCols(Array(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerTags&quot;)) .setOutputCol(&quot;nerChunks&quot;) val contextualAssertion = ContextualAssertion .pretrained(&quot;contextual_assertion_someoneelse&quot;, &quot;en&quot;, &quot;clinical/models&quot;) .setInputCols(&quot;sentences&quot;, &quot;tokens&quot;, &quot;nerChunks&quot;) .setOutputCol(&quot;assertion_someoneelse&quot;) val flattener = new Flattener() .setInputCols(&quot;assertion_someoneelse&quot;) .setExplodeSelectedFields(Map(&quot;assertion_someoneelse&quot; -&amp;gt; Array( &quot;metadata.ner_chunk as ner_chunk&quot;, &quot;begin as begin&quot;, &quot;end as end&quot;, &quot;metadata.ner_label as ner_label&quot;, &quot;result as result&quot; ))) val emptyDataSet = Seq(&quot;&quot;).toDS().toDF(&quot;text&quot;) val pipeline = new Pipeline() .setStages(Array( documentAssembler, sentenceDetector, tokenizer, embedder, nerTagger, nerConverter, contextualAssertion, flattener )).fit(emptyDataSet) val text = Seq(&quot;&quot;&quot;Her friend was diagnosed with hypertension. The nurse mentioned a colleague has influenza.&quot;&quot;&quot;).toDS.toDF(&quot;text&quot;) val dataSetResult = pipeline.transform(text) Results +--------------+-------+-----+-----------+-------------+ |ner_chunk |begin |end |ner_label |result | +--------------+-------+-----+-----------+-------------+ |hypertension |30 |41 |PROBLEM |someoneelse | |influenza |80 |88 |PROBLEM |someoneelse | +--------------+-------+-----+-----------+-------------+ Model Information Model Name: contextual_assertion_someoneelse Compatibility: Healthcare NLP 6.2.0+ License: Licensed Edition: Official Input Labels: [sentence, token, ner_chunk] Output Labels: [custom_someoneelse] Language: en Size: 1.8 KB Case sensitive: false</summary></entry></feed>